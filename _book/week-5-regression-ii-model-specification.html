<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Week 5: Regression II (Model Specification) | Intermediate Quantitative Methods</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Week 5: Regression II (Model Specification) | Intermediate Quantitative Methods" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Week 5: Regression II (Model Specification) | Intermediate Quantitative Methods" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Lucas Lemmann" />


<meta name="date" content="2023-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4-regression-i-prediction.html"/>
<link rel="next" href="week-6.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intermediate Quantitative Methods</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-exercises"><i class="fa fa-check"></i><b>1.1</b> How to use these exercises?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.2</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html"><i class="fa fa-check"></i><b>2</b> Week 1: DIYS 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#aims"><i class="fa fa-check"></i><b>2.1</b> Aims:</a></li>
<li class="chapter" data-level="2.2" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#first-part-descriptive-analysis"><i class="fa fa-check"></i><b>2.2</b> First Part: Descriptive Analysis</a></li>
<li class="chapter" data-level="2.3" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#second-part-exploratory-vs.-hypothesis-testing-analysis"><i class="fa fa-check"></i><b>2.3</b> Second Part: Exploratory VS. Hypothesis-Testing Analysis</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#preliminary-steps-do-this-before-doing-the-task-that-you-were-assigned-to"><i class="fa fa-check"></i><b>2.3.1</b> Preliminary steps: do this before doing the task that you were assigned to</a></li>
<li class="chapter" data-level="2.3.2" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#task-1"><i class="fa fa-check"></i><b>2.3.2</b> Task 1:</a></li>
<li class="chapter" data-level="2.3.3" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#task-2"><i class="fa fa-check"></i><b>2.3.3</b> Task 2:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#graph"><i class="fa fa-check"></i><b>2.4</b> Graph</a></li>
<li class="chapter" data-level="2.5" data-path="week-1-diys-1.html"><a href="week-1-diys-1.html#solution"><i class="fa fa-check"></i><b>2.5</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i><b>3</b> Week 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2.html"><a href="week-2.html#exercise"><i class="fa fa-check"></i><b>3.1</b> Exercise</a></li>
<li class="chapter" data-level="3.2" data-path="week-2.html"><a href="week-2.html#solution-1"><i class="fa fa-check"></i><b>3.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i><b>4</b> Week 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-3.html"><a href="week-3.html#exercise-1"><i class="fa fa-check"></i><b>4.1</b> Exercise</a></li>
<li class="chapter" data-level="4.2" data-path="week-3.html"><a href="week-3.html#solution-2"><i class="fa fa-check"></i><b>4.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html"><i class="fa fa-check"></i><b>5</b> Week 4: Regression I (Prediction)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#aims-1"><i class="fa fa-check"></i><b>5.1</b> Aims</a></li>
<li class="chapter" data-level="5.2" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#exercise-context-and-question"><i class="fa fa-check"></i><b>5.2</b> Exercise: Context and Question</a></li>
<li class="chapter" data-level="5.3" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#getting-the-data-first"><i class="fa fa-check"></i><b>5.3</b> Getting the data first</a></li>
<li class="chapter" data-level="5.4" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#exercise-solution"><i class="fa fa-check"></i><b>5.4</b> Exercise: solution</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#real-data"><i class="fa fa-check"></i><b>5.4.1</b> Real data</a></li>
<li class="chapter" data-level="5.4.2" data-path="week-4-regression-i-prediction.html"><a href="week-4-regression-i-prediction.html#simulated-data"><i class="fa fa-check"></i><b>5.4.2</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html"><i class="fa fa-check"></i><b>6</b> Week 5: Regression II (Model Specification)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#aims-2"><i class="fa fa-check"></i><b>6.1</b> Aims</a></li>
<li class="chapter" data-level="6.2" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#exercise-context-and-questions"><i class="fa fa-check"></i><b>6.2</b> Exercise: Context and Questions</a></li>
<li class="chapter" data-level="6.3" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#getting-the-data-first-1"><i class="fa fa-check"></i><b>6.3</b> Getting the data first</a></li>
<li class="chapter" data-level="6.4" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#exercise-solution-1"><i class="fa fa-check"></i><b>6.4</b> Exercise: solution</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#real-data-1"><i class="fa fa-check"></i><b>6.4.1</b> Real data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#interactive-line-plot"><i class="fa fa-check"></i><b>6.5</b> Interactive Line Plot</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="week-5-regression-ii-model-specification.html"><a href="week-5-regression-ii-model-specification.html#simulated-data-1"><i class="fa fa-check"></i><b>6.5.1</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i><b>7</b> Week 6</a>
<ul>
<li class="chapter" data-level="7.1" data-path="week-6.html"><a href="week-6.html#exercise-2"><i class="fa fa-check"></i><b>7.1</b> Exercise</a></li>
<li class="chapter" data-level="7.2" data-path="week-6.html"><a href="week-6.html#solution-3"><i class="fa fa-check"></i><b>7.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-7.html"><a href="week-7.html"><i class="fa fa-check"></i><b>8</b> Week 7</a>
<ul>
<li class="chapter" data-level="8.1" data-path="week-7.html"><a href="week-7.html#exercise-3"><i class="fa fa-check"></i><b>8.1</b> Exercise</a></li>
<li class="chapter" data-level="8.2" data-path="week-7.html"><a href="week-7.html#solution-4"><i class="fa fa-check"></i><b>8.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="week-8.html"><a href="week-8.html"><i class="fa fa-check"></i><b>9</b> Week 8</a>
<ul>
<li class="chapter" data-level="9.1" data-path="week-8.html"><a href="week-8.html#exercise-4"><i class="fa fa-check"></i><b>9.1</b> Exercise</a></li>
<li class="chapter" data-level="9.2" data-path="week-8.html"><a href="week-8.html#solution-5"><i class="fa fa-check"></i><b>9.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-9.html"><a href="week-9.html"><i class="fa fa-check"></i><b>10</b> Week 9</a>
<ul>
<li class="chapter" data-level="10.1" data-path="week-9.html"><a href="week-9.html#exercise-5"><i class="fa fa-check"></i><b>10.1</b> Exercise</a></li>
<li class="chapter" data-level="10.2" data-path="week-9.html"><a href="week-9.html#solution-6"><i class="fa fa-check"></i><b>10.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i><b>11</b> Week 10</a>
<ul>
<li class="chapter" data-level="11.1" data-path="week-10.html"><a href="week-10.html#exercise-6"><i class="fa fa-check"></i><b>11.1</b> Exercise</a></li>
<li class="chapter" data-level="11.2" data-path="week-10.html"><a href="week-10.html#solution-7"><i class="fa fa-check"></i><b>11.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="week-11.html"><a href="week-11.html"><i class="fa fa-check"></i><b>12</b> Week 11</a>
<ul>
<li class="chapter" data-level="12.1" data-path="week-11.html"><a href="week-11.html#exercise-7"><i class="fa fa-check"></i><b>12.1</b> Exercise</a></li>
<li class="chapter" data-level="12.2" data-path="week-11.html"><a href="week-11.html#solution-8"><i class="fa fa-check"></i><b>12.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="week-12.html"><a href="week-12.html"><i class="fa fa-check"></i><b>13</b> Week 12</a>
<ul>
<li class="chapter" data-level="13.1" data-path="week-12.html"><a href="week-12.html#exercise-8"><i class="fa fa-check"></i><b>13.1</b> Exercise</a></li>
<li class="chapter" data-level="13.2" data-path="week-12.html"><a href="week-12.html#solution-9"><i class="fa fa-check"></i><b>13.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="week-13.html"><a href="week-13.html"><i class="fa fa-check"></i><b>14</b> Week 13</a>
<ul>
<li class="chapter" data-level="14.1" data-path="week-13.html"><a href="week-13.html#exercise-9"><i class="fa fa-check"></i><b>14.1</b> Exercise</a></li>
<li class="chapter" data-level="14.2" data-path="week-13.html"><a href="week-13.html#solution-10"><i class="fa fa-check"></i><b>14.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="week-14.html"><a href="week-14.html"><i class="fa fa-check"></i><b>15</b> Week 14</a>
<ul>
<li class="chapter" data-level="15.1" data-path="week-14.html"><a href="week-14.html#exercise-10"><i class="fa fa-check"></i><b>15.1</b> Exercise</a></li>
<li class="chapter" data-level="15.2" data-path="week-14.html"><a href="week-14.html#solution-11"><i class="fa fa-check"></i><b>15.2</b> Solution</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published using bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate Quantitative Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-5-regression-ii-model-specification" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Week 5: Regression II (Model Specification)<a href="week-5-regression-ii-model-specification.html#week-5-regression-ii-model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="aims-2" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Aims<a href="week-5-regression-ii-model-specification.html#aims-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Using multiple regressors and interaction terms in regression analysis for quantitative descriptive purposes with real data</li>
<li>Using simulation to instantiate how different properties of the data generating process alter or not metrics of goodness of fit</li>
</ol>
<p><em><span style="color: red;">Should we request them to do descriptive statistics?</span>.</em>
<em><span style="color: red;">Check: are all list numerals fine?</span>.</em>
<em><span style="color: red;">Check: do all parameters in the interpretation texts fine?</span>.</em></p>
</div>
<div id="exercise-context-and-questions" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Exercise: Context and Questions<a href="week-5-regression-ii-model-specification.html#exercise-context-and-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Currently led by <a href="https://forscenter.ch/staff/anke-tresch/">Prof. Anke Tresch</a>, “[t]he Swiss Election Study (Selects) has been investigating the electoral behaviour of Swiss citizens in national elections since 1995. The project sheds light on the dynamics of the citizens’ opinion formation as well as on the determinants of their political participation and voting choice for a specific candidate or party.” See more <a href="https://forscenter.ch/projects/selects/">here</a>.</p>
<p>In this exercise, you will use data for the year 2019. You will use it to answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>Do older voters have stronger right leaning preferences than younger ones? age</li>
<li>Does that behavior change across sexes? sex</li>
<li>Does that behavior change depending on the main language spoken at the respondent’s home? f20221</li>
<li>What about the interaction sex-age?</li>
<li>What about the interaction sex-language?</li>
<li>What about the interaction age-language?</li>
<li>What about the interaction sex-age-language?</li>
<li>Do right leaning preferences become stronger the older voters are?</li>
</ol>
</div>
<div id="getting-the-data-first-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Getting the data first<a href="week-5-regression-ii-model-specification.html#getting-the-data-first-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Opening:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="week-5-regression-ii-model-specification.html#cb1-1" tabindex="-1"></a>selects19 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Documents/0_IPZ/2023_2/Leemann-QuantMethods/QuantitativeMethods/QuantitativeMethods/Data/SELECTS 2019/1179_Selects2019_PES_Data_v1.1.0.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="week-5-regression-ii-model-specification.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="week-5-regression-ii-model-specification.html#cb1-3" tabindex="-1"></a>selects19 <span class="ot">&lt;-</span> selects19 <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="week-5-regression-ii-model-specification.html#cb1-4" tabindex="-1"></a>  <span class="fu">select</span>(sex, age, <span class="fu">matches</span>(<span class="st">&quot;f15200&quot;</span>), f20221) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="week-5-regression-ii-model-specification.html#cb1-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(selects19<span class="sc">$</span>sex) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(selects19<span class="sc">$</span>age) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(selects19<span class="sc">$</span>f15200) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(selects19<span class="sc">$</span>f20221))  <span class="co"># Remove rows where x or y is NA</span></span>
<span id="cb1-6"><a href="week-5-regression-ii-model-specification.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="week-5-regression-ii-model-specification.html#cb1-7" tabindex="-1"></a>selects19<span class="sc">$</span>f15200 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(selects19<span class="sc">$</span>f15200)</span></code></pre></div>
<p>Labeling languages:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="week-5-regression-ii-model-specification.html#cb2-1" tabindex="-1"></a>selects19 <span class="ot">&lt;-</span> selects19 <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="week-5-regression-ii-model-specification.html#cb2-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LanguageHome =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-3"><a href="week-5-regression-ii-model-specification.html#cb2-3" tabindex="-1"></a>    f20221 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;German/Swiss German&quot;</span>,</span>
<span id="cb2-4"><a href="week-5-regression-ii-model-specification.html#cb2-4" tabindex="-1"></a>    f20221 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;French&quot;</span>,</span>
<span id="cb2-5"><a href="week-5-regression-ii-model-specification.html#cb2-5" tabindex="-1"></a>    f20221 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;Italian&quot;</span>,</span>
<span id="cb2-6"><a href="week-5-regression-ii-model-specification.html#cb2-6" tabindex="-1"></a>    f20221 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;Romansh&quot;</span>,</span>
<span id="cb2-7"><a href="week-5-regression-ii-model-specification.html#cb2-7" tabindex="-1"></a>    f20221 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span>))</span></code></pre></div>
<p>Labeling sex:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="week-5-regression-ii-model-specification.html#cb3-1" tabindex="-1"></a>selects19 <span class="ot">&lt;-</span> selects19 <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="week-5-regression-ii-model-specification.html#cb3-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-3"><a href="week-5-regression-ii-model-specification.html#cb3-3" tabindex="-1"></a>    sex <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb3-4"><a href="week-5-regression-ii-model-specification.html#cb3-4" tabindex="-1"></a>    sex <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;Female&quot;</span>))</span></code></pre></div>
<p>Renaming political preferences:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="week-5-regression-ii-model-specification.html#cb4-1" tabindex="-1"></a>selects19 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(selects19, <span class="at">LeftToRight =</span> f15200)</span></code></pre></div>
</div>
<div id="exercise-solution-1" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Exercise: solution<a href="week-5-regression-ii-model-specification.html#exercise-solution-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Note:</strong> Remember that you can copy the code from one point to answer another point. Simply make the necessary adjustments.</p>
<div id="real-data-1" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Real data<a href="week-5-regression-ii-model-specification.html#real-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Graph age vs. political preferences. Use a linear regression line to describe how the variables relate to each other.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="week-5-regression-ii-model-specification.html#cb5-1" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb5-2"><a href="week-5-regression-ii-model-specification.html#cb5-2" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>LeftToRight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="week-5-regression-ii-model-specification.html#cb5-3" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a href="week-5-regression-ii-model-specification.html#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="week-5-regression-ii-model-specification.html#cb5-5" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb5-6"><a href="week-5-regression-ii-model-specification.html#cb5-6" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="week-5-regression-ii-model-specification.html#cb5-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="week-5-regression-ii-model-specification.html#cb5-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb5-9"><a href="week-5-regression-ii-model-specification.html#cb5-9" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb5-10"><a href="week-5-regression-ii-model-specification.html#cb5-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb5-11"><a href="week-5-regression-ii-model-specification.html#cb5-11" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb5-12"><a href="week-5-regression-ii-model-specification.html#cb5-12" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb5-13"><a href="week-5-regression-ii-model-specification.html#cb5-13" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="week-5-regression-ii-model-specification.html#cb5-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-15"><a href="week-5-regression-ii-model-specification.html#cb5-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb5-16"><a href="week-5-regression-ii-model-specification.html#cb5-16" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-17"><a href="week-5-regression-ii-model-specification.html#cb5-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb5-18"><a href="week-5-regression-ii-model-specification.html#cb5-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb5-19"><a href="week-5-regression-ii-model-specification.html#cb5-19" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences&quot;</span></span>
<span id="cb5-20"><a href="week-5-regression-ii-model-specification.html#cb5-20" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Since the political preferences as well as years are defined in discrete values, many values can overlap for the same pair<code>(preference, age)</code>. Use the <code>ggridges</code> package to see how do preferences distribute across different age values.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="week-5-regression-ii-model-specification.html#cb6-1" tabindex="-1"></a><span class="co"># Assuming `data` is your dataframe with &#39;age&#39;, &#39;political_preference&#39; and &#39;LeftToRight&#39; as columns</span></span>
<span id="cb6-2"><a href="week-5-regression-ii-model-specification.html#cb6-2" tabindex="-1"></a><span class="co"># Replace `data`, `age`, `political_preference`, and `LeftToRight` with your actual dataframe and variable names.</span></span>
<span id="cb6-3"><a href="week-5-regression-ii-model-specification.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="week-5-regression-ii-model-specification.html#cb6-4" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> <span class="fu">as.factor</span>(LeftToRight), <span class="at">fill =</span> <span class="fu">as.factor</span>(LeftToRight))) <span class="sc">+</span></span>
<span id="cb6-5"><a href="week-5-regression-ii-model-specification.html#cb6-5" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="week-5-regression-ii-model-specification.html#cb6-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight, <span class="at">group =</span> <span class="dv">1</span>), </span>
<span id="cb6-7"><a href="week-5-regression-ii-model-specification.html#cb6-7" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="week-5-regression-ii-model-specification.html#cb6-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="week-5-regression-ii-model-specification.html#cb6-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="week-5-regression-ii-model-specification.html#cb6-10" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb6-11"><a href="week-5-regression-ii-model-specification.html#cb6-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="week-5-regression-ii-model-specification.html#cb6-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="week-5-regression-ii-model-specification.html#cb6-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb6-14"><a href="week-5-regression-ii-model-specification.html#cb6-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb6-15"><a href="week-5-regression-ii-model-specification.html#cb6-15" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Ridge Plot of Age by Number of Houses&quot;</span>,</span>
<span id="cb6-16"><a href="week-5-regression-ii-model-specification.html#cb6-16" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;factor(LeftToRight)&quot;</span>)</span></code></pre></div>
<pre><code>## Picking joint bandwidth of 4.52</code></pre>
<pre><code>## Warning: The following aesthetics were dropped during statistical transformation: fill
## ℹ This can happen when ggplot fails to infer the correct grouping structure in
##   the data.
## ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
##   variable into a factor?</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Regress the political preferences on age. As we learnt in the exercises from last week, the regression with intercept fits data better in most cases: act accordingly. Report and interpret the parameters. Graph some of the main components of the regression output.</li>
</ol>
<p>Write the regression here.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="week-5-regression-ii-model-specification.html#cb9-1" tabindex="-1"></a><span class="co">#regression</span></span>
<span id="cb9-2"><a href="week-5-regression-ii-model-specification.html#cb9-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb9-3"><a href="week-5-regression-ii-model-specification.html#cb9-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LeftToRight ~ age, data = selects19)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.9150 -2.0380 -0.0186  2.1958  5.5271 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 4.122055   0.106375  38.750   &lt;2e-16 ***
## age         0.019489   0.001979   9.846   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.649 on 5905 degrees of freedom
## Multiple R-squared:  0.01615,    Adjusted R-squared:  0.01598 
## F-statistic: 96.94 on 1 and 5905 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Report and interpret the parameters here.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="week-5-regression-ii-model-specification.html#cb11-1" tabindex="-1"></a>coeffs<span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb11-2"><a href="week-5-regression-ii-model-specification.html#cb11-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The beta value for&#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">1</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; and for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">2</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39;. </span><span class="sc">\n\n</span><span class="st">It means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; </span><span class="sc">\&#39;</span><span class="st">ideological units</span><span class="sc">\&#39;</span><span class="st">. Likewise, newborns can be expected to have an average ideological value of &#39;</span>,<span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>),<span class="st">&#39;, while 100 year old citizens can be expected to have an average ideological value of.&#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## The beta value for (Intercept)  is  4.12  and for  age  is  0.02 . 
## 
## It means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of  0.02  &#39;ideological units&#39;. Likewise, newborns can be expected to have an average ideological value of  4.12 , while 100 year old citizens can be expected to have an average ideological value of. 6.12</code></pre>
<p>Graph some of the main components of the regression output here.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="week-5-regression-ii-model-specification.html#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight)) <span class="sc">+</span>  <span class="co"># Removed selects19$ from aes(), not necessary</span></span>
<span id="cb13-2"><a href="week-5-regression-ii-model-specification.html#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.001</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="week-5-regression-ii-model-specification.html#cb13-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb13-4"><a href="week-5-regression-ii-model-specification.html#cb13-4" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="week-5-regression-ii-model-specification.html#cb13-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Newborn&quot;</span>,</span>
<span id="cb13-6"><a href="week-5-regression-ii-model-specification.html#cb13-6" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb13-7"><a href="week-5-regression-ii-model-specification.html#cb13-7" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.2</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])),</span>
<span id="cb13-8"><a href="week-5-regression-ii-model-specification.html#cb13-8" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb13-9"><a href="week-5-regression-ii-model-specification.html#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="week-5-regression-ii-model-specification.html#cb13-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb13-11"><a href="week-5-regression-ii-model-specification.html#cb13-11" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="week-5-regression-ii-model-specification.html#cb13-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Average individual over time&quot;</span>,</span>
<span id="cb13-13"><a href="week-5-regression-ii-model-specification.html#cb13-13" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb13-14"><a href="week-5-regression-ii-model-specification.html#cb13-14" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.4</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)),</span>
<span id="cb13-15"><a href="week-5-regression-ii-model-specification.html#cb13-15" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="week-5-regression-ii-model-specification.html#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="week-5-regression-ii-model-specification.html#cb13-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-18"><a href="week-5-regression-ii-model-specification.html#cb13-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb13-19"><a href="week-5-regression-ii-model-specification.html#cb13-19" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-20"><a href="week-5-regression-ii-model-specification.html#cb13-20" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb13-21"><a href="week-5-regression-ii-model-specification.html#cb13-21" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb13-22"><a href="week-5-regression-ii-model-specification.html#cb13-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lines Using Parameters from Regression&quot;</span></span>
<span id="cb13-23"><a href="week-5-regression-ii-model-specification.html#cb13-23" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning: Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Now add the regressor <code>Sex</code> and do the same as in the previous point.
Write the regression here.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="week-5-regression-ii-model-specification.html#cb16-1" tabindex="-1"></a><span class="co">#regression</span></span>
<span id="cb16-2"><a href="week-5-regression-ii-model-specification.html#cb16-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age <span class="sc">+</span> Sex, <span class="at">data =</span> selects19)</span>
<span id="cb16-3"><a href="week-5-regression-ii-model-specification.html#cb16-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LeftToRight ~ age + Sex, data = selects19)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.2108 -1.9784  0.0954  2.1145  5.8236 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 3.840287   0.109636  35.028   &lt;2e-16 ***
## age         0.018672   0.001966   9.496   &lt;2e-16 ***
## SexMale     0.652678   0.068477   9.531   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.629 on 5904 degrees of freedom
## Multiple R-squared:  0.03106,    Adjusted R-squared:  0.03073 
## F-statistic: 94.63 on 2 and 5904 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Report and interpret the parameters here.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="week-5-regression-ii-model-specification.html#cb18-1" tabindex="-1"></a>coeffs<span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb18-2"><a href="week-5-regression-ii-model-specification.html#cb18-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The beta value for&#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">1</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">2</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; and for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">3</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-3"><a href="week-5-regression-ii-model-specification.html#cb18-3" tabindex="-1"></a>    </span>
<span id="cb18-4"><a href="week-5-regression-ii-model-specification.html#cb18-4" tabindex="-1"></a><span class="st">&#39;. </span><span class="sc">\n\n</span><span class="st">It means that, given our model,  an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; </span><span class="sc">\&#39;</span><span class="st">ideological units</span><span class="sc">\&#39;</span><span class="st">. Likewise, newborns can be expected to have an average ideological value of &#39;</span>,<span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>),<span class="st">&#39;, while 100 year old female citizens can be expected to have an average ideological value of.&#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39;. Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; ideological units higher than a female individual under the same statistical circumstances.&#39;</span>)</span></code></pre></div>
<pre><code>## The beta value for (Intercept)  is  3.84  for  age  is  0.02  and for  SexMale  is  0.65 . 
## 
## It means that, given our model,  an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of  0.02  &#39;ideological units&#39;. Likewise, newborns can be expected to have an average ideological value of  3.84 , while 100 year old female citizens can be expected to have an average ideological value of. 5.84 . Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of  0.65  ideological units higher than a female individual under the same statistical circumstances.</code></pre>
<p>Graph some of the main components of the regression output here.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="week-5-regression-ii-model-specification.html#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight)) <span class="sc">+</span>  <span class="co"># Removed selects19$ from aes(), not necessary</span></span>
<span id="cb20-2"><a href="week-5-regression-ii-model-specification.html#cb20-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.001</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="week-5-regression-ii-model-specification.html#cb20-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb20-4"><a href="week-5-regression-ii-model-specification.html#cb20-4" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="week-5-regression-ii-model-specification.html#cb20-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Newborn female&quot;</span>,</span>
<span id="cb20-6"><a href="week-5-regression-ii-model-specification.html#cb20-6" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb20-7"><a href="week-5-regression-ii-model-specification.html#cb20-7" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.2</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])),</span>
<span id="cb20-8"><a href="week-5-regression-ii-model-specification.html#cb20-8" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb20-9"><a href="week-5-regression-ii-model-specification.html#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="week-5-regression-ii-model-specification.html#cb20-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb20-11"><a href="week-5-regression-ii-model-specification.html#cb20-11" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="week-5-regression-ii-model-specification.html#cb20-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Female over time&quot;</span>,</span>
<span id="cb20-13"><a href="week-5-regression-ii-model-specification.html#cb20-13" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb20-14"><a href="week-5-regression-ii-model-specification.html#cb20-14" tabindex="-1"></a>                <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.8</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)),</span>
<span id="cb20-15"><a href="week-5-regression-ii-model-specification.html#cb20-15" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="week-5-regression-ii-model-specification.html#cb20-16" tabindex="-1"></a></span>
<span id="cb20-17"><a href="week-5-regression-ii-model-specification.html#cb20-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]),</span>
<span id="cb20-18"><a href="week-5-regression-ii-model-specification.html#cb20-18" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="week-5-regression-ii-model-specification.html#cb20-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Male over time (newborn bonus)&quot;</span>,</span>
<span id="cb20-20"><a href="week-5-regression-ii-model-specification.html#cb20-20" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb20-21"><a href="week-5-regression-ii-model-specification.html#cb20-21" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.6</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="fl">0.2</span>),</span>
<span id="cb20-22"><a href="week-5-regression-ii-model-specification.html#cb20-22" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-23"><a href="week-5-regression-ii-model-specification.html#cb20-23" tabindex="-1"></a></span>
<span id="cb20-24"><a href="week-5-regression-ii-model-specification.html#cb20-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-25"><a href="week-5-regression-ii-model-specification.html#cb20-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="week-5-regression-ii-model-specification.html#cb20-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-27"><a href="week-5-regression-ii-model-specification.html#cb20-27" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb20-28"><a href="week-5-regression-ii-model-specification.html#cb20-28" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb20-29"><a href="week-5-regression-ii-model-specification.html#cb20-29" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lines Using Parameters from Regression&quot;</span></span>
<span id="cb20-30"><a href="week-5-regression-ii-model-specification.html#cb20-30" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>You now remember that average preferences can change not only across age and sex independently, but simultaneously: i.e., the average preferences across individuals in a same sex can change at different rates over time as well as begin from different points. Add the interaction <code>Age</code> and <code>Sex</code> and do the same as in the previous point.</li>
</ol>
<p>Write the regression here.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="week-5-regression-ii-model-specification.html#cb22-1" tabindex="-1"></a><span class="co">#regression</span></span>
<span id="cb22-2"><a href="week-5-regression-ii-model-specification.html#cb22-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age <span class="sc">*</span> Sex, <span class="at">data =</span> selects19)</span>
<span id="cb22-3"><a href="week-5-regression-ii-model-specification.html#cb22-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LeftToRight ~ age * Sex, data = selects19)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.9332 -2.0641  0.0372  2.1848  6.0372 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.506922   0.146203  23.987  &lt; 2e-16 ***
## age          0.025327   0.002756   9.189  &lt; 2e-16 ***
## SexMale      1.340734   0.211254   6.347 2.37e-10 ***
## age:SexMale -0.013528   0.003930  -3.443  0.00058 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.626 on 5903 degrees of freedom
## Multiple R-squared:  0.033,  Adjusted R-squared:  0.03251 
## F-statistic: 67.15 on 3 and 5903 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Report and interpret the parameters here.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="week-5-regression-ii-model-specification.html#cb24-1" tabindex="-1"></a>coeffs<span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb24-2"><a href="week-5-regression-ii-model-specification.html#cb24-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The beta value for&#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">1</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">2</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">3</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>),<span class="st">&#39; and for &#39;</span>, <span class="fu">names</span>(coeffs[<span class="dv">4</span>]), <span class="st">&#39; is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">4</span>]), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb24-3"><a href="week-5-regression-ii-model-specification.html#cb24-3" tabindex="-1"></a>    </span>
<span id="cb24-4"><a href="week-5-regression-ii-model-specification.html#cb24-4" tabindex="-1"></a><span class="st">&#39;. </span><span class="sc">\n\n</span><span class="st">It means that, given our model,  an increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; </span><span class="sc">\&#39;</span><span class="st">ideological units</span><span class="sc">\&#39;</span><span class="st">. Likewise, female newborns can be expected to have an average ideological value of &#39;</span>,<span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>),<span class="st">&#39;, while 100 year old female citizens can be expected to have an average ideological value of.&#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39;. </span><span class="sc">\n\n</span><span class="st">Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; ideological units higher (i.e., self declare more right leaning) than a female individual under the same statistical circumstances. Finally, the rate at which right leaning prefferences increase over time is &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">4</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*-</span><span class="dv">1</span>, <span class="st">&#39; lower than a female in the same statistical circumstances. Therefore, a 100 year old male can be expected to have an political preference of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">4</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## The beta value for (Intercept)  is  3.51  for  age  is  0.03  for  SexMale  is  1.34  and for  age:SexMale  is  -0.01 . 
## 
## It means that, given our model,  an increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of  0.03  &#39;ideological units&#39;. Likewise, female newborns can be expected to have an average ideological value of  3.51 , while 100 year old female citizens can be expected to have an average ideological value of. 6.51 . 
## 
## Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of  1.34  ideological units higher (i.e., self declare more right leaning) than a female individual under the same statistical circumstances. Finally, the rate at which right leaning prefferences increase over time is  0.01  lower than a female in the same statistical circumstances. Therefore, a 100 year old male can be expected to have an political preference of  6.85</code></pre>
<p>Graph some of the main components of the regression output here.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="week-5-regression-ii-model-specification.html#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="week-5-regression-ii-model-specification.html#cb26-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="week-5-regression-ii-model-specification.html#cb26-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb26-4"><a href="week-5-regression-ii-model-specification.html#cb26-4" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="week-5-regression-ii-model-specification.html#cb26-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Newborn female&quot;</span>,</span>
<span id="cb26-6"><a href="week-5-regression-ii-model-specification.html#cb26-6" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb26-7"><a href="week-5-regression-ii-model-specification.html#cb26-7" tabindex="-1"></a>                <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])),</span>
<span id="cb26-8"><a href="week-5-regression-ii-model-specification.html#cb26-8" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb26-9"><a href="week-5-regression-ii-model-specification.html#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="week-5-regression-ii-model-specification.html#cb26-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb26-11"><a href="week-5-regression-ii-model-specification.html#cb26-11" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="week-5-regression-ii-model-specification.html#cb26-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Female over time&quot;</span>,</span>
<span id="cb26-13"><a href="week-5-regression-ii-model-specification.html#cb26-13" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb26-14"><a href="week-5-regression-ii-model-specification.html#cb26-14" tabindex="-1"></a>                <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.8</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)),</span>
<span id="cb26-15"><a href="week-5-regression-ii-model-specification.html#cb26-15" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-16"><a href="week-5-regression-ii-model-specification.html#cb26-16" tabindex="-1"></a></span>
<span id="cb26-17"><a href="week-5-regression-ii-model-specification.html#cb26-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]),</span>
<span id="cb26-18"><a href="week-5-regression-ii-model-specification.html#cb26-18" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">4</span>]), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="week-5-regression-ii-model-specification.html#cb26-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Male over time (newborn bonus+Δslope)&quot;</span>,</span>
<span id="cb26-20"><a href="week-5-regression-ii-model-specification.html#cb26-20" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb26-21"><a href="week-5-regression-ii-model-specification.html#cb26-21" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.45</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]) <span class="sc">+</span> (<span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">4</span>])) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)),</span>
<span id="cb26-22"><a href="week-5-regression-ii-model-specification.html#cb26-22" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-23"><a href="week-5-regression-ii-model-specification.html#cb26-23" tabindex="-1"></a>  </span>
<span id="cb26-24"><a href="week-5-regression-ii-model-specification.html#cb26-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-25"><a href="week-5-regression-ii-model-specification.html#cb26-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-26"><a href="week-5-regression-ii-model-specification.html#cb26-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-27"><a href="week-5-regression-ii-model-specification.html#cb26-27" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb26-28"><a href="week-5-regression-ii-model-specification.html#cb26-28" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb26-29"><a href="week-5-regression-ii-model-specification.html#cb26-29" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lines Using Parameters from Regression&quot;</span></span>
<span id="cb26-30"><a href="week-5-regression-ii-model-specification.html#cb26-30" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Following the same logic as in the previous point, you now add the <code>LanguageHome</code> categorical variable with the corresponding interactions. Do the same as in the previous point.</li>
</ol>
<p>Write the regression here.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="week-5-regression-ii-model-specification.html#cb28-1" tabindex="-1"></a><span class="co">#regression</span></span>
<span id="cb28-2"><a href="week-5-regression-ii-model-specification.html#cb28-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age <span class="sc">*</span> Sex <span class="sc">*</span> LanguageHome, <span class="at">data =</span> selects19)</span>
<span id="cb28-3"><a href="week-5-regression-ii-model-specification.html#cb28-3" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LeftToRight ~ age * Sex * LanguageHome, data = selects19)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.1650 -2.0129  0.0157  2.0714  6.1504 
## 
## Coefficients:
##                                               Estimate Std. Error t value
## (Intercept)                                  3.4304317  0.2328505  14.732
## age                                          0.0232899  0.0043627   5.338
## SexMale                                      1.2217711  0.3489102   3.502
## LanguageHomeGerman/Swiss German              0.0096680  0.3214760   0.030
## LanguageHomeItalian                          1.4371272  0.5006063   2.871
## LanguageHomeOther                           -1.1059089  0.6179065  -1.790
## LanguageHomeRomansh                         -2.3047615  3.5040694  -0.658
## age:SexMale                                 -0.0140639  0.0065181  -2.158
## age:LanguageHomeGerman/Swiss German          0.0053104  0.0060152   0.883
## age:LanguageHomeItalian                     -0.0154796  0.0095441  -1.622
## age:LanguageHomeOther                        0.0169430  0.0126468   1.340
## age:LanguageHomeRomansh                      0.0425055  0.0732632   0.580
## SexMale:LanguageHomeGerman/Swiss German      0.1885585  0.4684575   0.403
## SexMale:LanguageHomeItalian                 -0.5629460  0.7043389  -0.799
## SexMale:LanguageHomeOther                    1.6468317  0.9783983   1.683
## SexMale:LanguageHomeRomansh                  1.0259620  4.0396347   0.254
## age:SexMale:LanguageHomeGerman/Swiss German  0.0002337  0.0086831   0.027
## age:SexMale:LanguageHomeItalian              0.0124492  0.0133246   0.934
## age:SexMale:LanguageHomeOther               -0.0265266  0.0193016  -1.374
## age:SexMale:LanguageHomeRomansh              0.0041536  0.0833735   0.050
##                                             Pr(&gt;|t|)    
## (Intercept)                                  &lt; 2e-16 ***
## age                                         9.73e-08 ***
## SexMale                                     0.000466 ***
## LanguageHomeGerman/Swiss German             0.976009    
## LanguageHomeItalian                         0.004109 ** 
## LanguageHomeOther                           0.073543 .  
## LanguageHomeRomansh                         0.510732    
## age:SexMale                                 0.030994 *  
## age:LanguageHomeGerman/Swiss German         0.377368    
## age:LanguageHomeItalian                     0.104877    
## age:LanguageHomeOther                       0.180393    
## age:LanguageHomeRomansh                     0.561819    
## SexMale:LanguageHomeGerman/Swiss German     0.687324    
## SexMale:LanguageHomeItalian                 0.424175    
## SexMale:LanguageHomeOther                   0.092391 .  
## SexMale:LanguageHomeRomansh                 0.799525    
## age:SexMale:LanguageHomeGerman/Swiss German 0.978527    
## age:SexMale:LanguageHomeItalian             0.350189    
## age:SexMale:LanguageHomeOther               0.169395    
## age:SexMale:LanguageHomeRomansh             0.960268    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.615 on 5887 degrees of freedom
## Multiple R-squared:  0.04377,    Adjusted R-squared:  0.04068 
## F-statistic: 14.18 on 19 and 5887 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Report and interpret the parameters here.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="week-5-regression-ii-model-specification.html#cb30-1" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb30-2"><a href="week-5-regression-ii-model-specification.html#cb30-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Interpreting a regression with ever more interactions is exponentially harder! Thus, find below some few cases aimed at signaling the general logic in the interpretation.&#39;</span>,</span>
<span id="cb30-3"><a href="week-5-regression-ii-model-specification.html#cb30-3" tabindex="-1"></a>    </span>
<span id="cb30-4"><a href="week-5-regression-ii-model-specification.html#cb30-4" tabindex="-1"></a><span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">An increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&#39; </span><span class="sc">\&#39;</span><span class="st">ideological units</span><span class="sc">\&#39;</span><span class="st">. Likewise, female newborns whose household speaks mainly in French can be expected to have an average ideological value of &#39;</span>,<span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>),<span class="st">&#39;, while a 100 year old female citizens whose household speaks mainly in French can be expected to have an average ideological value of.&#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, </span>
<span id="cb30-5"><a href="week-5-regression-ii-model-specification.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="week-5-regression-ii-model-specification.html#cb30-6" tabindex="-1"></a><span class="st">&#39;.</span><span class="sc">\n\n</span><span class="st">Similarly, should one observe a random 100 year old male individual whose household speaks mainly in German, we can expected him have an average of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">8</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">9</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">13</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">17</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39; ideological units higher than a female newborn whose household speaks mainly in French. Consequently, the expected ideological value for the former would be of &#39;</span>, <span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">3</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">8</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">9</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">13</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">round</span>(<span class="fu">unname</span>(coeffs[<span class="dv">17</span>]), <span class="at">digits =</span> <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Interpreting a regression with ever more interactions is exponentially harder! Thus, find below some few cases aimed at signaling the general logic in the interpretation. 
## 
## An increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of  0.02  &#39;ideological units&#39;. Likewise, female newborns whose household speaks mainly in French can be expected to have an average ideological value of  3.43 , while a 100 year old female citizens whose household speaks mainly in French can be expected to have an average ideological value of. 5.43 .
## 
## Similarly, should one observe a random 100 year old male individual whose household speaks mainly in German, we can expected him have an average of  3.41  ideological units higher than a female newborn whose household speaks mainly in French. Consequently, the expected ideological value for the former would be of  6.84</code></pre>
<p>Graph some of the main components of the regression output here.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="week-5-regression-ii-model-specification.html#cb32-1" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> LeftToRight)) <span class="sc">+</span>  <span class="co"># Removed selects19$ from aes(), not necessary</span></span>
<span id="cb32-2"><a href="week-5-regression-ii-model-specification.html#cb32-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="week-5-regression-ii-model-specification.html#cb32-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb32-4"><a href="week-5-regression-ii-model-specification.html#cb32-4" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="week-5-regression-ii-model-specification.html#cb32-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Newborn female French speaking household&quot;</span>,</span>
<span id="cb32-6"><a href="week-5-regression-ii-model-specification.html#cb32-6" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb32-7"><a href="week-5-regression-ii-model-specification.html#cb32-7" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])),</span>
<span id="cb32-8"><a href="week-5-regression-ii-model-specification.html#cb32-8" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>)<span class="sc">+</span> </span>
<span id="cb32-9"><a href="week-5-regression-ii-model-specification.html#cb32-9" tabindex="-1"></a></span>
<span id="cb32-10"><a href="week-5-regression-ii-model-specification.html#cb32-10" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]),</span>
<span id="cb32-11"><a href="week-5-regression-ii-model-specification.html#cb32-11" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="week-5-regression-ii-model-specification.html#cb32-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Female French speaking household over time&quot;</span>,</span>
<span id="cb32-13"><a href="week-5-regression-ii-model-specification.html#cb32-13" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb32-14"><a href="week-5-regression-ii-model-specification.html#cb32-14" tabindex="-1"></a>                <span class="at">y =</span> <span class="sc">-</span><span class="fl">1.6</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)),</span>
<span id="cb32-15"><a href="week-5-regression-ii-model-specification.html#cb32-15" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-16"><a href="week-5-regression-ii-model-specification.html#cb32-16" tabindex="-1"></a></span>
<span id="cb32-17"><a href="week-5-regression-ii-model-specification.html#cb32-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]),</span>
<span id="cb32-18"><a href="week-5-regression-ii-model-specification.html#cb32-18" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">8</span>]), <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-19"><a href="week-5-regression-ii-model-specification.html#cb32-19" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Male French household over time (newborn bonus+Δslope)&quot;</span>,</span>
<span id="cb32-20"><a href="week-5-regression-ii-model-specification.html#cb32-20" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb32-21"><a href="week-5-regression-ii-model-specification.html#cb32-21" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">0.4</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>]) <span class="sc">+</span> (<span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">8</span>])) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="fl">0.2</span>),</span>
<span id="cb32-22"><a href="week-5-regression-ii-model-specification.html#cb32-22" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-23"><a href="week-5-regression-ii-model-specification.html#cb32-23" tabindex="-1"></a>  </span>
<span id="cb32-24"><a href="week-5-regression-ii-model-specification.html#cb32-24" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">13</span>]),</span>
<span id="cb32-25"><a href="week-5-regression-ii-model-specification.html#cb32-25" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">8</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">17</span>]), <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-26"><a href="week-5-regression-ii-model-specification.html#cb32-26" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Male German household over time (newborn &amp; ling. bonus+Δslope)&quot;</span>,</span>
<span id="cb32-27"><a href="week-5-regression-ii-model-specification.html#cb32-27" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="dv">10</span>,</span>
<span id="cb32-28"><a href="week-5-regression-ii-model-specification.html#cb32-28" tabindex="-1"></a>                <span class="at">y =</span> <span class="fl">1.2</span><span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">3</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">13</span>]) <span class="sc">+</span> (<span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">8</span>])<span class="sc">+</span><span class="fu">unname</span>(coeffs[<span class="dv">17</span>])) <span class="sc">*</span> <span class="fu">max</span>(selects19<span class="sc">$</span>age)<span class="sc">+</span><span class="fl">0.2</span>),</span>
<span id="cb32-29"><a href="week-5-regression-ii-model-specification.html#cb32-29" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb32-30"><a href="week-5-regression-ii-model-specification.html#cb32-30" tabindex="-1"></a>  <span class="co"># geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3]),</span></span>
<span id="cb32-31"><a href="week-5-regression-ii-model-specification.html#cb32-31" tabindex="-1"></a>  <span class="co">#             slope = unname(coeffs[2])+unname(coeffs[4]), color = &quot;blue&quot;, size = 1) +</span></span>
<span id="cb32-32"><a href="week-5-regression-ii-model-specification.html#cb32-32" tabindex="-1"></a>  <span class="co"># geom_text(aes(label = &quot;Int.(fem)+Male+Age*Male&quot;,</span></span>
<span id="cb32-33"><a href="week-5-regression-ii-model-specification.html#cb32-33" tabindex="-1"></a>  <span class="co">#               x = max(selects19$age)+10,</span></span>
<span id="cb32-34"><a href="week-5-regression-ii-model-specification.html#cb32-34" tabindex="-1"></a>  <span class="co">#               y = 0.3+unname(coeffs[1])+unname(coeffs[3]) + (unname(coeffs[2])+unname(coeffs[4])) * max(selects19$age)+0.2),</span></span>
<span id="cb32-35"><a href="week-5-regression-ii-model-specification.html#cb32-35" tabindex="-1"></a>  <span class="co">#               hjust = 1, vjust = 0, color = &quot;blue&quot;) +</span></span>
<span id="cb32-36"><a href="week-5-regression-ii-model-specification.html#cb32-36" tabindex="-1"></a>  </span>
<span id="cb32-37"><a href="week-5-regression-ii-model-specification.html#cb32-37" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-38"><a href="week-5-regression-ii-model-specification.html#cb32-38" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-39"><a href="week-5-regression-ii-model-specification.html#cb32-39" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-40"><a href="week-5-regression-ii-model-specification.html#cb32-40" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb32-41"><a href="week-5-regression-ii-model-specification.html#cb32-41" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb32-42"><a href="week-5-regression-ii-model-specification.html#cb32-42" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Lines Using Parameters from Regression&quot;</span></span>
<span id="cb32-43"><a href="week-5-regression-ii-model-specification.html#cb32-43" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.
## Use of `selects19$age` is discouraged.
## ℹ Use `age` instead.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p><em><span style="color: red;">Ojo: Check that interpretations have the right parameters!</span>.</em></p>
</div>
</div>
<div id="interactive-line-plot" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Interactive Line Plot<a href="week-5-regression-ii-model-specification.html#interactive-line-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em><span style="color: red;">Should we exploit this here or somewhere else? I can make it work in R, but not in the book yet. If needed, I can check it out.</span>.</em></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="week-5-regression-ii-model-specification.html#cb34-1" tabindex="-1"></a><span class="co"># # Example data frame</span></span>
<span id="cb34-2"><a href="week-5-regression-ii-model-specification.html#cb34-2" tabindex="-1"></a><span class="co"># data &lt;- data.frame(</span></span>
<span id="cb34-3"><a href="week-5-regression-ii-model-specification.html#cb34-3" tabindex="-1"></a><span class="co">#   x = rnorm(100),</span></span>
<span id="cb34-4"><a href="week-5-regression-ii-model-specification.html#cb34-4" tabindex="-1"></a><span class="co">#   y = rnorm(100)</span></span>
<span id="cb34-5"><a href="week-5-regression-ii-model-specification.html#cb34-5" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb34-6"><a href="week-5-regression-ii-model-specification.html#cb34-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-7"><a href="week-5-regression-ii-model-specification.html#cb34-7" tabindex="-1"></a><span class="co"># # Shiny server function</span></span>
<span id="cb34-8"><a href="week-5-regression-ii-model-specification.html#cb34-8" tabindex="-1"></a><span class="co"># server &lt;- function(input, output) {</span></span>
<span id="cb34-9"><a href="week-5-regression-ii-model-specification.html#cb34-9" tabindex="-1"></a><span class="co">#   output$scatterPlot &lt;- renderPlot({</span></span>
<span id="cb34-10"><a href="week-5-regression-ii-model-specification.html#cb34-10" tabindex="-1"></a><span class="co">#     ggplot(data, aes(x = x, y = y)) +  # Ensure &#39;data&#39; is your data frame</span></span>
<span id="cb34-11"><a href="week-5-regression-ii-model-specification.html#cb34-11" tabindex="-1"></a><span class="co">#       geom_point(size = 0) +</span></span>
<span id="cb34-12"><a href="week-5-regression-ii-model-specification.html#cb34-12" tabindex="-1"></a><span class="co">#       geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1)</span></span>
<span id="cb34-13"><a href="week-5-regression-ii-model-specification.html#cb34-13" tabindex="-1"></a><span class="co">#   })</span></span>
<span id="cb34-14"><a href="week-5-regression-ii-model-specification.html#cb34-14" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb34-15"><a href="week-5-regression-ii-model-specification.html#cb34-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-16"><a href="week-5-regression-ii-model-specification.html#cb34-16" tabindex="-1"></a><span class="co"># # Example data frame</span></span>
<span id="cb34-17"><a href="week-5-regression-ii-model-specification.html#cb34-17" tabindex="-1"></a><span class="co"># data &lt;- data.frame(</span></span>
<span id="cb34-18"><a href="week-5-regression-ii-model-specification.html#cb34-18" tabindex="-1"></a><span class="co">#   x = rnorm(100),</span></span>
<span id="cb34-19"><a href="week-5-regression-ii-model-specification.html#cb34-19" tabindex="-1"></a><span class="co">#   y = rnorm(100)</span></span>
<span id="cb34-20"><a href="week-5-regression-ii-model-specification.html#cb34-20" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb34-21"><a href="week-5-regression-ii-model-specification.html#cb34-21" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-22"><a href="week-5-regression-ii-model-specification.html#cb34-22" tabindex="-1"></a><span class="co"># # Shiny server function</span></span>
<span id="cb34-23"><a href="week-5-regression-ii-model-specification.html#cb34-23" tabindex="-1"></a><span class="co"># server &lt;- function(input, output) {</span></span>
<span id="cb34-24"><a href="week-5-regression-ii-model-specification.html#cb34-24" tabindex="-1"></a><span class="co">#   output$scatterPlot &lt;- renderPlot({</span></span>
<span id="cb34-25"><a href="week-5-regression-ii-model-specification.html#cb34-25" tabindex="-1"></a><span class="co">#     ggplot(data, aes(x = x, y = y)) +  # Ensure &#39;data&#39; is your data frame</span></span>
<span id="cb34-26"><a href="week-5-regression-ii-model-specification.html#cb34-26" tabindex="-1"></a><span class="co">#       geom_point(size = 0) +</span></span>
<span id="cb34-27"><a href="week-5-regression-ii-model-specification.html#cb34-27" tabindex="-1"></a><span class="co">#       geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1)</span></span>
<span id="cb34-28"><a href="week-5-regression-ii-model-specification.html#cb34-28" tabindex="-1"></a><span class="co">#   })</span></span>
<span id="cb34-29"><a href="week-5-regression-ii-model-specification.html#cb34-29" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb34-30"><a href="week-5-regression-ii-model-specification.html#cb34-30" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-31"><a href="week-5-regression-ii-model-specification.html#cb34-31" tabindex="-1"></a><span class="co"># update.packages(ask = FALSE)</span></span>
<span id="cb34-32"><a href="week-5-regression-ii-model-specification.html#cb34-32" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-33"><a href="week-5-regression-ii-model-specification.html#cb34-33" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-34"><a href="week-5-regression-ii-model-specification.html#cb34-34" tabindex="-1"></a><span class="co"># library(shiny)</span></span>
<span id="cb34-35"><a href="week-5-regression-ii-model-specification.html#cb34-35" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb34-36"><a href="week-5-regression-ii-model-specification.html#cb34-36" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-37"><a href="week-5-regression-ii-model-specification.html#cb34-37" tabindex="-1"></a><span class="co"># ui &lt;- fluidPage(</span></span>
<span id="cb34-38"><a href="week-5-regression-ii-model-specification.html#cb34-38" tabindex="-1"></a><span class="co">#   titlePanel(&quot;Interactive Line Plot&quot;),</span></span>
<span id="cb34-39"><a href="week-5-regression-ii-model-specification.html#cb34-39" tabindex="-1"></a><span class="co">#   sidebarLayout(</span></span>
<span id="cb34-40"><a href="week-5-regression-ii-model-specification.html#cb34-40" tabindex="-1"></a><span class="co">#     sidebarPanel(</span></span>
<span id="cb34-41"><a href="week-5-regression-ii-model-specification.html#cb34-41" tabindex="-1"></a><span class="co">#       sliderInput(&quot;intercept&quot;, &quot;Intercept:&quot;, min = -10, max = 10, value = 0),</span></span>
<span id="cb34-42"><a href="week-5-regression-ii-model-specification.html#cb34-42" tabindex="-1"></a><span class="co">#       sliderInput(&quot;slope&quot;, &quot;Slope:&quot;, min = -10, max = 10, value = 1)</span></span>
<span id="cb34-43"><a href="week-5-regression-ii-model-specification.html#cb34-43" tabindex="-1"></a><span class="co">#     ),</span></span>
<span id="cb34-44"><a href="week-5-regression-ii-model-specification.html#cb34-44" tabindex="-1"></a><span class="co">#     mainPanel(</span></span>
<span id="cb34-45"><a href="week-5-regression-ii-model-specification.html#cb34-45" tabindex="-1"></a><span class="co">#       plotOutput(&quot;scatterPlot&quot;)</span></span>
<span id="cb34-46"><a href="week-5-regression-ii-model-specification.html#cb34-46" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb34-47"><a href="week-5-regression-ii-model-specification.html#cb34-47" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb34-48"><a href="week-5-regression-ii-model-specification.html#cb34-48" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb34-49"><a href="week-5-regression-ii-model-specification.html#cb34-49" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-50"><a href="week-5-regression-ii-model-specification.html#cb34-50" tabindex="-1"></a><span class="co"># server &lt;- function(input, output) {</span></span>
<span id="cb34-51"><a href="week-5-regression-ii-model-specification.html#cb34-51" tabindex="-1"></a><span class="co">#   output$scatterPlot &lt;- renderPlot({</span></span>
<span id="cb34-52"><a href="week-5-regression-ii-model-specification.html#cb34-52" tabindex="-1"></a><span class="co">#     ggplot(data, aes(x = x, y = y)) +</span></span>
<span id="cb34-53"><a href="week-5-regression-ii-model-specification.html#cb34-53" tabindex="-1"></a><span class="co">#       geom_point(size = 0) +</span></span>
<span id="cb34-54"><a href="week-5-regression-ii-model-specification.html#cb34-54" tabindex="-1"></a><span class="co">#       geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1)</span></span>
<span id="cb34-55"><a href="week-5-regression-ii-model-specification.html#cb34-55" tabindex="-1"></a><span class="co">#   })</span></span>
<span id="cb34-56"><a href="week-5-regression-ii-model-specification.html#cb34-56" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb34-57"><a href="week-5-regression-ii-model-specification.html#cb34-57" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-58"><a href="week-5-regression-ii-model-specification.html#cb34-58" tabindex="-1"></a><span class="co"># shinyApp(ui = ui, server = server)</span></span></code></pre></div>
<div id="simulated-data-1" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Simulated data<a href="week-5-regression-ii-model-specification.html#simulated-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>In order to see the logic behind the <span class="math inline">\(R^2\)</span>, first estimate the linear regression of <code>LeftToRight</code> on <code>Age</code>. Generate the variable <code>predicted_LeftToRight</code> with the generated parameters using <a href="https://www.statology.org/r-lm-predict/"><code>predict()</code></a> from the point 3 of the previous section (i.e., the one using real data).Generate the graph <code>predicted_LeftToRight</code> vs <code>Age</code>.</li>
</ol>
<p>Report the regression here.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="week-5-regression-ii-model-specification.html#cb35-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb35-2"><a href="week-5-regression-ii-model-specification.html#cb35-2" tabindex="-1"></a>selects19<span class="sc">$</span>predicted_LeftToRight <span class="ot">&lt;-</span> <span class="fu">predict</span>(result)</span>
<span id="cb35-3"><a href="week-5-regression-ii-model-specification.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="week-5-regression-ii-model-specification.html#cb35-4" tabindex="-1"></a>coeffs1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb35-5"><a href="week-5-regression-ii-model-specification.html#cb35-5" tabindex="-1"></a>rsq_sd1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb35-6"><a href="week-5-regression-ii-model-specification.html#cb35-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The R2 is: &#39;</span>, rsq_sd1, <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">Intercept:&#39;</span>,<span class="fu">unname</span>(coeffs1[<span class="dv">1</span>]), <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">Slope:&#39;</span>, <span class="fu">unname</span>(coeffs1[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## The R2 is:  0.0161515 
## 
## Intercept: 4.122055 
## 
## Slope: 0.01948902</code></pre>
<p>Report the graph here.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="week-5-regression-ii-model-specification.html#cb37-1" tabindex="-1"></a><span class="co"># Calculate means for Y and X</span></span>
<span id="cb37-2"><a href="week-5-regression-ii-model-specification.html#cb37-2" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>LeftToRight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-3"><a href="week-5-regression-ii-model-specification.html#cb37-3" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-4"><a href="week-5-regression-ii-model-specification.html#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="week-5-regression-ii-model-specification.html#cb37-5" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb37-6"><a href="week-5-regression-ii-model-specification.html#cb37-6" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> predicted_LeftToRight)) <span class="sc">+</span></span>
<span id="cb37-7"><a href="week-5-regression-ii-model-specification.html#cb37-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb37-8"><a href="week-5-regression-ii-model-specification.html#cb37-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb37-9"><a href="week-5-regression-ii-model-specification.html#cb37-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb37-10"><a href="week-5-regression-ii-model-specification.html#cb37-10" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-11"><a href="week-5-regression-ii-model-specification.html#cb37-11" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb37-12"><a href="week-5-regression-ii-model-specification.html#cb37-12" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)  </span>
<span id="cb37-13"><a href="week-5-regression-ii-model-specification.html#cb37-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-14"><a href="week-5-regression-ii-model-specification.html#cb37-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-15"><a href="week-5-regression-ii-model-specification.html#cb37-15" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-16"><a href="week-5-regression-ii-model-specification.html#cb37-16" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb37-17"><a href="week-5-regression-ii-model-specification.html#cb37-17" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb37-18"><a href="week-5-regression-ii-model-specification.html#cb37-18" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb37-19"><a href="week-5-regression-ii-model-specification.html#cb37-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-20"><a href="week-5-regression-ii-model-specification.html#cb37-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-21"><a href="week-5-regression-ii-model-specification.html#cb37-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb37-22"><a href="week-5-regression-ii-model-specification.html#cb37-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb37-23"><a href="week-5-regression-ii-model-specification.html#cb37-23" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences (determ. sim.)&quot;</span></span>
<span id="cb37-24"><a href="week-5-regression-ii-model-specification.html#cb37-24" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
## ℹ Please use the `linewidth` argument instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Now generate the normally distributed residuals with mean zero and the same variance as the residuals of the model from the previous point.</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="week-5-regression-ii-model-specification.html#cb39-1" tabindex="-1"></a><span class="co"># Calculate the variance of the residuals</span></span>
<span id="cb39-2"><a href="week-5-regression-ii-model-specification.html#cb39-2" tabindex="-1"></a>selects19<span class="sc">$</span>residual <span class="ot">&lt;-</span> <span class="fu">resid</span>(result)</span>
<span id="cb39-3"><a href="week-5-regression-ii-model-specification.html#cb39-3" tabindex="-1"></a>residual_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">resid</span>(result)))</span>
<span id="cb39-4"><a href="week-5-regression-ii-model-specification.html#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="week-5-regression-ii-model-specification.html#cb39-5" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb39-6"><a href="week-5-regression-ii-model-specification.html#cb39-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb39-7"><a href="week-5-regression-ii-model-specification.html#cb39-7" tabindex="-1"></a>selects19<span class="sc">$</span>NormResiduals1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(selects19), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> residual_sd)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Simulate new data using both the deterministic (i.e., the the parameters estimated immediately above) and stochastic component (i.e., the residuals form the previous point). Graph the simulated data.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="week-5-regression-ii-model-specification.html#cb40-1" tabindex="-1"></a>selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch <span class="ot">&lt;-</span> selects19<span class="sc">$</span>predicted_LeftToRight <span class="sc">+</span> selects19<span class="sc">$</span>NormResiduals1</span>
<span id="cb40-2"><a href="week-5-regression-ii-model-specification.html#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="week-5-regression-ii-model-specification.html#cb40-3" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb40-4"><a href="week-5-regression-ii-model-specification.html#cb40-4" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-5"><a href="week-5-regression-ii-model-specification.html#cb40-5" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-6"><a href="week-5-regression-ii-model-specification.html#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="week-5-regression-ii-model-specification.html#cb40-7" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb40-8"><a href="week-5-regression-ii-model-specification.html#cb40-8" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> Sim_LeftToRight_Det_Stoch)) <span class="sc">+</span></span>
<span id="cb40-9"><a href="week-5-regression-ii-model-specification.html#cb40-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="week-5-regression-ii-model-specification.html#cb40-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb40-11"><a href="week-5-regression-ii-model-specification.html#cb40-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb40-12"><a href="week-5-regression-ii-model-specification.html#cb40-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb40-13"><a href="week-5-regression-ii-model-specification.html#cb40-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-14"><a href="week-5-regression-ii-model-specification.html#cb40-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb40-15"><a href="week-5-regression-ii-model-specification.html#cb40-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb40-16"><a href="week-5-regression-ii-model-specification.html#cb40-16" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb40-17"><a href="week-5-regression-ii-model-specification.html#cb40-17" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb40-18"><a href="week-5-regression-ii-model-specification.html#cb40-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-19"><a href="week-5-regression-ii-model-specification.html#cb40-19" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-20"><a href="week-5-regression-ii-model-specification.html#cb40-20" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb40-21"><a href="week-5-regression-ii-model-specification.html#cb40-21" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb40-22"><a href="week-5-regression-ii-model-specification.html#cb40-22" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb40-23"><a href="week-5-regression-ii-model-specification.html#cb40-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-24"><a href="week-5-regression-ii-model-specification.html#cb40-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-25"><a href="week-5-regression-ii-model-specification.html#cb40-25" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb40-26"><a href="week-5-regression-ii-model-specification.html#cb40-26" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Simulation: Political Preferences (left to right)&quot;</span>,</span>
<span id="cb40-27"><a href="week-5-regression-ii-model-specification.html#cb40-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences </span><span class="sc">\n</span><span class="st">(determ.&amp; stoch. sim.)&quot;</span></span>
<span id="cb40-28"><a href="week-5-regression-ii-model-specification.html#cb40-28" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Removed 366 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 366 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Now, estimate the regression between the real <code>age</code> and simulated <code>Sim_LeftToRight_Det_Stoch</code>. Once you do that, generate the <span class="math inline">\(R^2\)</span> for the model.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="week-5-regression-ii-model-specification.html#cb43-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb43-2"><a href="week-5-regression-ii-model-specification.html#cb43-2" tabindex="-1"></a>rsq_sd1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb43-3"><a href="week-5-regression-ii-model-specification.html#cb43-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The R2 is: &#39;</span>, rsq_sd1)</span></code></pre></div>
<pre><code>## The R2 is:  0.0161515</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Repeat the previous three points but use half the standard deviation of the model of point 1. Is the <span class="math inline">\(R^2\)</span> lower now? Why? See <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">this</a> entry to understand the intuition: pay special attention to the graph with the red and blue squares.</li>
</ol>
<p>Generate the residuals here.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="week-5-regression-ii-model-specification.html#cb45-1" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb45-2"><a href="week-5-regression-ii-model-specification.html#cb45-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb45-3"><a href="week-5-regression-ii-model-specification.html#cb45-3" tabindex="-1"></a>selects19<span class="sc">$</span>NormResiduals10 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(selects19), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> residual_sd<span class="sc">*</span><span class="fl">0.1</span>)</span></code></pre></div>
<p>Simulate new data and graph it here.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="week-5-regression-ii-model-specification.html#cb46-1" tabindex="-1"></a>selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch_sd10 <span class="ot">&lt;-</span> selects19<span class="sc">$</span>predicted_LeftToRight <span class="sc">+</span> selects19<span class="sc">$</span>NormResiduals10</span>
<span id="cb46-2"><a href="week-5-regression-ii-model-specification.html#cb46-2" tabindex="-1"></a></span>
<span id="cb46-3"><a href="week-5-regression-ii-model-specification.html#cb46-3" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb46-4"><a href="week-5-regression-ii-model-specification.html#cb46-4" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch_sd10, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-5"><a href="week-5-regression-ii-model-specification.html#cb46-5" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-6"><a href="week-5-regression-ii-model-specification.html#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="week-5-regression-ii-model-specification.html#cb46-7" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb46-8"><a href="week-5-regression-ii-model-specification.html#cb46-8" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> Sim_LeftToRight_Det_Stoch_sd10)) <span class="sc">+</span></span>
<span id="cb46-9"><a href="week-5-regression-ii-model-specification.html#cb46-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb46-10"><a href="week-5-regression-ii-model-specification.html#cb46-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb46-11"><a href="week-5-regression-ii-model-specification.html#cb46-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb46-12"><a href="week-5-regression-ii-model-specification.html#cb46-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb46-13"><a href="week-5-regression-ii-model-specification.html#cb46-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb46-14"><a href="week-5-regression-ii-model-specification.html#cb46-14" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb46-15"><a href="week-5-regression-ii-model-specification.html#cb46-15" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb46-16"><a href="week-5-regression-ii-model-specification.html#cb46-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-17"><a href="week-5-regression-ii-model-specification.html#cb46-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb46-18"><a href="week-5-regression-ii-model-specification.html#cb46-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-19"><a href="week-5-regression-ii-model-specification.html#cb46-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb46-20"><a href="week-5-regression-ii-model-specification.html#cb46-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Simulated data (half sd): Political Preferences (left to right)&quot;</span>,</span>
<span id="cb46-21"><a href="week-5-regression-ii-model-specification.html#cb46-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences&quot;</span></span>
<span id="cb46-22"><a href="week-5-regression-ii-model-specification.html#cb46-22" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Report the new <span class="math inline">\(R^2\)</span> here:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="week-5-regression-ii-model-specification.html#cb47-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sim_LeftToRight_Det_Stoch_sd10 <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb47-2"><a href="week-5-regression-ii-model-specification.html#cb47-2" tabindex="-1"></a>rsq_sd10 <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb47-3"><a href="week-5-regression-ii-model-specification.html#cb47-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The R2 is: &#39;</span>, rsq_sd10)</span></code></pre></div>
<pre><code>## The R2 is:  0.625503</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Repeat the previous point but use a hundredth the standard deviation of the model of point 1. Is the <span class="math inline">\(R^2\)</span> lower now? Why?</li>
</ol>
<p>Generate the residuals here.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="week-5-regression-ii-model-specification.html#cb49-1" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb49-2"><a href="week-5-regression-ii-model-specification.html#cb49-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb49-3"><a href="week-5-regression-ii-model-specification.html#cb49-3" tabindex="-1"></a>selects19<span class="sc">$</span>NormResiduals100 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(selects19), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> residual_sd<span class="sc">*</span><span class="fl">0.01</span>)</span></code></pre></div>
<p>Simulate new data and graph it here.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="week-5-regression-ii-model-specification.html#cb50-1" tabindex="-1"></a>selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch_hsd <span class="ot">&lt;-</span> selects19<span class="sc">$</span>predicted_LeftToRight <span class="sc">+</span> selects19<span class="sc">$</span>NormResiduals100</span>
<span id="cb50-2"><a href="week-5-regression-ii-model-specification.html#cb50-2" tabindex="-1"></a></span>
<span id="cb50-3"><a href="week-5-regression-ii-model-specification.html#cb50-3" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb50-4"><a href="week-5-regression-ii-model-specification.html#cb50-4" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>Sim_LeftToRight_Det_Stoch_hsd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-5"><a href="week-5-regression-ii-model-specification.html#cb50-5" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-6"><a href="week-5-regression-ii-model-specification.html#cb50-6" tabindex="-1"></a></span>
<span id="cb50-7"><a href="week-5-regression-ii-model-specification.html#cb50-7" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb50-8"><a href="week-5-regression-ii-model-specification.html#cb50-8" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> Sim_LeftToRight_Det_Stoch_hsd)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="week-5-regression-ii-model-specification.html#cb50-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a href="week-5-regression-ii-model-specification.html#cb50-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb50-11"><a href="week-5-regression-ii-model-specification.html#cb50-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb50-12"><a href="week-5-regression-ii-model-specification.html#cb50-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb50-13"><a href="week-5-regression-ii-model-specification.html#cb50-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb50-14"><a href="week-5-regression-ii-model-specification.html#cb50-14" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb50-15"><a href="week-5-regression-ii-model-specification.html#cb50-15" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-16"><a href="week-5-regression-ii-model-specification.html#cb50-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-17"><a href="week-5-regression-ii-model-specification.html#cb50-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb50-18"><a href="week-5-regression-ii-model-specification.html#cb50-18" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-19"><a href="week-5-regression-ii-model-specification.html#cb50-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb50-20"><a href="week-5-regression-ii-model-specification.html#cb50-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Simulated data (half sd): Political Preferences (left to right)&quot;</span>,</span>
<span id="cb50-21"><a href="week-5-regression-ii-model-specification.html#cb50-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences&quot;</span></span>
<span id="cb50-22"><a href="week-5-regression-ii-model-specification.html#cb50-22" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Report the new <span class="math inline">\(R^2\)</span> here:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="week-5-regression-ii-model-specification.html#cb51-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sim_LeftToRight_Det_Stoch_hsd <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb51-2"><a href="week-5-regression-ii-model-specification.html#cb51-2" tabindex="-1"></a>rsq_sd100 <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb51-3"><a href="week-5-regression-ii-model-specification.html#cb51-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The R2 is: &#39;</span>, rsq_sd100)</span></code></pre></div>
<pre><code>## The R2 is:  0.9939772</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Present in a table the <span class="math inline">\(R^2\)</span> for each value of the standard deviation.</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="week-5-regression-ii-model-specification.html#cb53-1" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-2"><a href="week-5-regression-ii-model-specification.html#cb53-2" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>),</span>
<span id="cb53-3"><a href="week-5-regression-ii-model-specification.html#cb53-3" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">c</span>(rsq_sd1, rsq_sd10, rsq_sd100)    <span class="co"># Replace these with the actual R-squared values</span></span>
<span id="cb53-4"><a href="week-5-regression-ii-model-specification.html#cb53-4" tabindex="-1"></a>)</span>
<span id="cb53-5"><a href="week-5-regression-ii-model-specification.html#cb53-5" tabindex="-1"></a></span>
<span id="cb53-6"><a href="week-5-regression-ii-model-specification.html#cb53-6" tabindex="-1"></a><span class="fu">print</span>(table)</span></code></pre></div>
<pre><code>##     SD        R2
## 1 1.00 0.0161515
## 2 0.10 0.6255030
## 3 0.01 0.9939772</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Graph <span class="math inline">\(R^2\)</span> agains the standard deviation fraction. Fit a linear regression line.</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="week-5-regression-ii-model-specification.html#cb55-1" tabindex="-1"></a><span class="fu">ggplot</span>(table, <span class="fu">aes</span>(<span class="at">x =</span> SD, <span class="at">y =</span> R2)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="week-5-regression-ii-model-specification.html#cb55-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="week-5-regression-ii-model-specification.html#cb55-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-4"><a href="week-5-regression-ii-model-specification.html#cb55-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-5"><a href="week-5-regression-ii-model-specification.html#cb55-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb55-6"><a href="week-5-regression-ii-model-specification.html#cb55-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-7"><a href="week-5-regression-ii-model-specification.html#cb55-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Fraction of standard deviation&quot;</span>,</span>
<span id="cb55-8"><a href="week-5-regression-ii-model-specification.html#cb55-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;R2&quot;</span>,</span>
<span id="cb55-9"><a href="week-5-regression-ii-model-specification.html#cb55-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Relation between R2 and standard deviation of residuals&quot;</span></span>
<span id="cb55-10"><a href="week-5-regression-ii-model-specification.html#cb55-10" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" />
9. [Optional] Graph <span class="math inline">\(R^2\)</span> against the standard deviation fraction. Fit a regression line with a polynomial of degree 2. The regression line fits the data better. Is the polynomial regression more informative than the linear regression? Why? What lesson does this graph give you in terms of the importance of understanding the theoretical relations between variables beyond what an empirical approach could suggest? What does it teach you regarding the tension between under- and over-fitting data?</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="week-5-regression-ii-model-specification.html#cb56-1" tabindex="-1"></a><span class="fu">ggplot</span>(table, <span class="fu">aes</span>(<span class="at">x =</span> SD, <span class="at">y =</span> R2)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="week-5-regression-ii-model-specification.html#cb56-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-3"><a href="week-5-regression-ii-model-specification.html#cb56-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">&#39;green&#39;</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="week-5-regression-ii-model-specification.html#cb56-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="week-5-regression-ii-model-specification.html#cb56-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="week-5-regression-ii-model-specification.html#cb56-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-7"><a href="week-5-regression-ii-model-specification.html#cb56-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Fraction of standard deviation&quot;</span>,</span>
<span id="cb56-8"><a href="week-5-regression-ii-model-specification.html#cb56-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;R2&quot;</span>,</span>
<span id="cb56-9"><a href="week-5-regression-ii-model-specification.html#cb56-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Relation between R2 and standard deviation of residuals&quot;</span></span>
<span id="cb56-10"><a href="week-5-regression-ii-model-specification.html#cb56-10" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" />
10. Print the parameters generated in the point 1. Generate the same predictions as in point 1 and 2 but this time multiply the slope’s parameter by 5, while keeping the intercept unchanged. Call the resulting predictions <code>predicted_LeftToRight_AdjSlope</code> Generate a graph with the regression line for <code>predicted_LeftToRight_AdjSlope</code> vs <code>Age</code> and compare it with the graph <code>predicted_LeftToRight</code> vs <code>Age</code> generated in point 1.</p>
<p>Print here</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="week-5-regression-ii-model-specification.html#cb57-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(LeftToRight <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb57-2"><a href="week-5-regression-ii-model-specification.html#cb57-2" tabindex="-1"></a><span class="co"># summary(result)</span></span>
<span id="cb57-3"><a href="week-5-regression-ii-model-specification.html#cb57-3" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb57-4"><a href="week-5-regression-ii-model-specification.html#cb57-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Intercept:&#39;</span>,<span class="fu">unname</span>(coeffs[<span class="dv">1</span>]), <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">Slope:&#39;</span>, <span class="fu">unname</span>(coeffs[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## Intercept: 4.122055 
## 
## Slope: 0.01948902</code></pre>
<p>Predict with the adjusted slope here.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="week-5-regression-ii-model-specification.html#cb59-1" tabindex="-1"></a>selects19<span class="sc">$</span>predicted_LeftToRight_AdjSlope <span class="ot">&lt;-</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>])<span class="sc">+</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>])<span class="sc">*</span><span class="dv">5</span>)<span class="sc">*</span>selects19<span class="sc">$</span>age</span></code></pre></div>
<p>Generate the graph here.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="week-5-regression-ii-model-specification.html#cb60-1" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb60-2"><a href="week-5-regression-ii-model-specification.html#cb60-2" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>predicted_LeftToRight_AdjSlope, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-3"><a href="week-5-regression-ii-model-specification.html#cb60-3" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-4"><a href="week-5-regression-ii-model-specification.html#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="week-5-regression-ii-model-specification.html#cb60-5" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb60-6"><a href="week-5-regression-ii-model-specification.html#cb60-6" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> predicted_LeftToRight_AdjSlope)) <span class="sc">+</span></span>
<span id="cb60-7"><a href="week-5-regression-ii-model-specification.html#cb60-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb60-8"><a href="week-5-regression-ii-model-specification.html#cb60-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb60-9"><a href="week-5-regression-ii-model-specification.html#cb60-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb60-10"><a href="week-5-regression-ii-model-specification.html#cb60-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-11"><a href="week-5-regression-ii-model-specification.html#cb60-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb60-12"><a href="week-5-regression-ii-model-specification.html#cb60-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb60-13"><a href="week-5-regression-ii-model-specification.html#cb60-13" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb60-14"><a href="week-5-regression-ii-model-specification.html#cb60-14" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb60-15"><a href="week-5-regression-ii-model-specification.html#cb60-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-16"><a href="week-5-regression-ii-model-specification.html#cb60-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-17"><a href="week-5-regression-ii-model-specification.html#cb60-17" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb60-18"><a href="week-5-regression-ii-model-specification.html#cb60-18" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb60-19"><a href="week-5-regression-ii-model-specification.html#cb60-19" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb60-20"><a href="week-5-regression-ii-model-specification.html#cb60-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-21"><a href="week-5-regression-ii-model-specification.html#cb60-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-22"><a href="week-5-regression-ii-model-specification.html#cb60-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb60-23"><a href="week-5-regression-ii-model-specification.html#cb60-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb60-24"><a href="week-5-regression-ii-model-specification.html#cb60-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences (adj. slope)&quot;</span></span>
<span id="cb60-25"><a href="week-5-regression-ii-model-specification.html#cb60-25" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" />
11. Add to the deterministic simulation the same stochastic component generated in point 2. Call that variable <code>predicted_LeftToRight_AdjSlope_Stoch</code>. Generate the graph <code>predicted_LeftToRight_AdjSlope_Stoch</code> vs <code>age</code> with a linear regression line. Generate the <span class="math inline">\(R^2\)</span> and compare it to the one generated in point 4. Why is the new <span class="math inline">\(R^2\)</span> higher than the one in point 4?</p>
<p>Report the simulation and the graph here.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="week-5-regression-ii-model-specification.html#cb61-1" tabindex="-1"></a>selects19<span class="sc">$</span>predicted_LeftToRight_AdjSlope_Stoch <span class="ot">&lt;-</span> selects19<span class="sc">$</span>predicted_LeftToRight_AdjSlope <span class="sc">+</span> selects19<span class="sc">$</span>NormResiduals1</span>
<span id="cb61-2"><a href="week-5-regression-ii-model-specification.html#cb61-2" tabindex="-1"></a></span>
<span id="cb61-3"><a href="week-5-regression-ii-model-specification.html#cb61-3" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb61-4"><a href="week-5-regression-ii-model-specification.html#cb61-4" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>predicted_LeftToRight_AdjSlope_Stoch, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-5"><a href="week-5-regression-ii-model-specification.html#cb61-5" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-6"><a href="week-5-regression-ii-model-specification.html#cb61-6" tabindex="-1"></a></span>
<span id="cb61-7"><a href="week-5-regression-ii-model-specification.html#cb61-7" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb61-8"><a href="week-5-regression-ii-model-specification.html#cb61-8" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> predicted_LeftToRight_AdjSlope_Stoch)) <span class="sc">+</span></span>
<span id="cb61-9"><a href="week-5-regression-ii-model-specification.html#cb61-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="week-5-regression-ii-model-specification.html#cb61-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb61-11"><a href="week-5-regression-ii-model-specification.html#cb61-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb61-12"><a href="week-5-regression-ii-model-specification.html#cb61-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb61-13"><a href="week-5-regression-ii-model-specification.html#cb61-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb61-14"><a href="week-5-regression-ii-model-specification.html#cb61-14" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb61-15"><a href="week-5-regression-ii-model-specification.html#cb61-15" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-16"><a href="week-5-regression-ii-model-specification.html#cb61-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-17"><a href="week-5-regression-ii-model-specification.html#cb61-17" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb61-18"><a href="week-5-regression-ii-model-specification.html#cb61-18" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb61-19"><a href="week-5-regression-ii-model-specification.html#cb61-19" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb61-20"><a href="week-5-regression-ii-model-specification.html#cb61-20" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb61-21"><a href="week-5-regression-ii-model-specification.html#cb61-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-22"><a href="week-5-regression-ii-model-specification.html#cb61-22" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-23"><a href="week-5-regression-ii-model-specification.html#cb61-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb61-24"><a href="week-5-regression-ii-model-specification.html#cb61-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Simulation: Political Preferences (left to right)&quot;</span>,</span>
<span id="cb61-25"><a href="week-5-regression-ii-model-specification.html#cb61-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences </span><span class="sc">\n</span><span class="st">(determ.&amp; stoch. sim. with adjusted slope)&quot;</span></span>
<span id="cb61-26"><a href="week-5-regression-ii-model-specification.html#cb61-26" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Report the new <span class="math inline">\(R^2\)</span> here:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="week-5-regression-ii-model-specification.html#cb64-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(predicted_LeftToRight_AdjSlope_Stoch <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb64-2"><a href="week-5-regression-ii-model-specification.html#cb64-2" tabindex="-1"></a>rsq_sd1_AdjSlope <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb64-3"><a href="week-5-regression-ii-model-specification.html#cb64-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The R2 is: &#39;</span>, rsq_sd1_AdjSlope)</span></code></pre></div>
<pre><code>## The R2 is:  0.2973214</code></pre>
<p>Report why is the new <span class="math inline">\(R^2\)</span> higher than the one in point 4?</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="week-5-regression-ii-model-specification.html#cb66-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;The reason the R2 increased is that, while the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged), by increasing the slope of the generating process, the average distance between each observation and the average observation increased (i.e., Y</span><span class="sc">\&#39;</span><span class="st">s variance increased). See the graph with the red and blue squares mentioned in point 5.&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The reason the R2 increased is that, while the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged), by increasing the slope of the generating process, the average distance between each observation and the average observation increased (i.e., Y&#39;s variance increased). See the graph with the red and blue squares mentioned in point 5.&quot;</code></pre>
<p>333333333333</p>
<ol start="12" style="list-style-type: decimal">
<li>Print the parameters generated in the point 1. Generate the same predictions as in point 1 and 2 but this time increase in two units the <em>intercept’s</em> parameter (not the <em>slope’s</em> parameter as in the point 10), while keeping the slope unchanged. Call the resulting predictions <code>predicted_LeftToRight_AdjSlope</code> Generate a graph with the regression line for <code>predicted_LeftToRight_AdjSlope</code> vs <code>Age</code> and compare it with the graph <code>predicted_LeftToRight</code> vs <code>Age</code> generated in point 1.</li>
</ol>
<p>Print here</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="week-5-regression-ii-model-specification.html#cb68-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(predicted_LeftToRight_AdjSlope_Stoch <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb68-2"><a href="week-5-regression-ii-model-specification.html#cb68-2" tabindex="-1"></a><span class="co"># summary(result)</span></span>
<span id="cb68-3"><a href="week-5-regression-ii-model-specification.html#cb68-3" tabindex="-1"></a>coeffs12 <span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb68-4"><a href="week-5-regression-ii-model-specification.html#cb68-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Intercept:&#39;</span>,<span class="fu">unname</span>(coeffs12[<span class="dv">1</span>]), <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">Slope:&#39;</span>, <span class="fu">unname</span>(coeffs12[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## Intercept: 4.071965 
## 
## Slope: 0.09874777</code></pre>
<p>Predict with the adjusted slope here.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="week-5-regression-ii-model-specification.html#cb70-1" tabindex="-1"></a>selects19<span class="sc">$</span>predicted_LeftToRight_AdjIntecept <span class="ot">&lt;-</span> <span class="fu">unname</span>(coeffs[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="fu">unname</span>(coeffs[<span class="dv">2</span>]))<span class="sc">*</span>selects19<span class="sc">$</span>age</span></code></pre></div>
<p>Generate the graph here.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="week-5-regression-ii-model-specification.html#cb71-1" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb71-2"><a href="week-5-regression-ii-model-specification.html#cb71-2" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>predicted_LeftToRight_AdjIntecept, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-3"><a href="week-5-regression-ii-model-specification.html#cb71-3" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-4"><a href="week-5-regression-ii-model-specification.html#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="week-5-regression-ii-model-specification.html#cb71-5" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb71-6"><a href="week-5-regression-ii-model-specification.html#cb71-6" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> predicted_LeftToRight_AdjIntecept)) <span class="sc">+</span></span>
<span id="cb71-7"><a href="week-5-regression-ii-model-specification.html#cb71-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb71-8"><a href="week-5-regression-ii-model-specification.html#cb71-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb71-9"><a href="week-5-regression-ii-model-specification.html#cb71-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb71-10"><a href="week-5-regression-ii-model-specification.html#cb71-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-11"><a href="week-5-regression-ii-model-specification.html#cb71-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb71-12"><a href="week-5-regression-ii-model-specification.html#cb71-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb71-13"><a href="week-5-regression-ii-model-specification.html#cb71-13" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb71-14"><a href="week-5-regression-ii-model-specification.html#cb71-14" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb71-15"><a href="week-5-regression-ii-model-specification.html#cb71-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-16"><a href="week-5-regression-ii-model-specification.html#cb71-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb71-17"><a href="week-5-regression-ii-model-specification.html#cb71-17" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb71-18"><a href="week-5-regression-ii-model-specification.html#cb71-18" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb71-19"><a href="week-5-regression-ii-model-specification.html#cb71-19" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb71-20"><a href="week-5-regression-ii-model-specification.html#cb71-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb71-21"><a href="week-5-regression-ii-model-specification.html#cb71-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb71-22"><a href="week-5-regression-ii-model-specification.html#cb71-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb71-23"><a href="week-5-regression-ii-model-specification.html#cb71-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Political Preferences (left to right)&quot;</span>,</span>
<span id="cb71-24"><a href="week-5-regression-ii-model-specification.html#cb71-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences (adj. slope)&quot;</span></span>
<span id="cb71-25"><a href="week-5-regression-ii-model-specification.html#cb71-25" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" />
13. Add to the deterministic simulation the same stochastic component generated in point 2. Call that variable <code>predicted_LeftToRight_AdjIntercep_Stoch</code>. Generate the graph <code>predicted_LeftToRight_AdjIntecept</code> vs <code>age</code> with a linear regression line. Generate the <span class="math inline">\(R^2\)</span> and compare it to the one generated in point 4. Why is the new <span class="math inline">\(R^2\)</span> higher than the one in point 4?</p>
<p>Report the simulation and the graph here.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="week-5-regression-ii-model-specification.html#cb72-1" tabindex="-1"></a>selects19<span class="sc">$</span>predicted_LeftToRight_AdjIntercept_Stoch <span class="ot">&lt;-</span> selects19<span class="sc">$</span>predicted_LeftToRight_AdjIntecept <span class="sc">+</span> selects19<span class="sc">$</span>residual</span>
<span id="cb72-2"><a href="week-5-regression-ii-model-specification.html#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="week-5-regression-ii-model-specification.html#cb72-3" tabindex="-1"></a><span class="co">#Means for Y and X</span></span>
<span id="cb72-4"><a href="week-5-regression-ii-model-specification.html#cb72-4" tabindex="-1"></a>mean_LeftRight <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>predicted_LeftToRight_AdjIntercept_Stoch, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-5"><a href="week-5-regression-ii-model-specification.html#cb72-5" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(selects19<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-6"><a href="week-5-regression-ii-model-specification.html#cb72-6" tabindex="-1"></a></span>
<span id="cb72-7"><a href="week-5-regression-ii-model-specification.html#cb72-7" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb72-8"><a href="week-5-regression-ii-model-specification.html#cb72-8" tabindex="-1"></a><span class="fu">ggplot</span>(selects19, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> predicted_LeftToRight_AdjIntercept_Stoch)) <span class="sc">+</span></span>
<span id="cb72-9"><a href="week-5-regression-ii-model-specification.html#cb72-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="week-5-regression-ii-model-specification.html#cb72-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># Adding the regression line</span></span>
<span id="cb72-11"><a href="week-5-regression-ii-model-specification.html#cb72-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_LeftRight, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span>  <span class="co"># Horizontal line at the mean of y</span></span>
<span id="cb72-12"><a href="week-5-regression-ii-model-specification.html#cb72-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_age, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span>  <span class="co"># Vertical line at the mean of x</span></span>
<span id="cb72-13"><a href="week-5-regression-ii-model-specification.html#cb72-13" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb72-14"><a href="week-5-regression-ii-model-specification.html#cb72-14" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb72-15"><a href="week-5-regression-ii-model-specification.html#cb72-15" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb72-16"><a href="week-5-regression-ii-model-specification.html#cb72-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-17"><a href="week-5-regression-ii-model-specification.html#cb72-17" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-18"><a href="week-5-regression-ii-model-specification.html#cb72-18" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># Center the plot title</span></span>
<span id="cb72-19"><a href="week-5-regression-ii-model-specification.html#cb72-19" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># Style for major Y grid lines</span></span>
<span id="cb72-20"><a href="week-5-regression-ii-model-specification.html#cb72-20" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>() <span class="co"># Remove minor Y grid lines</span></span>
<span id="cb72-21"><a href="week-5-regression-ii-model-specification.html#cb72-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-22"><a href="week-5-regression-ii-model-specification.html#cb72-22" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb72-23"><a href="week-5-regression-ii-model-specification.html#cb72-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb72-24"><a href="week-5-regression-ii-model-specification.html#cb72-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Simulation: Political Preferences (left to right)&quot;</span>,</span>
<span id="cb72-25"><a href="week-5-regression-ii-model-specification.html#cb72-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter plot Age vs. Political Preferences </span><span class="sc">\n</span><span class="st">(determ.&amp; stoch. sim. with adjusted intercept)&quot;</span></span>
<span id="cb72-26"><a href="week-5-regression-ii-model-specification.html#cb72-26" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-44-1.png" width="672" />
Regress the <code>predicted_LeftToRight_AdjIntercept_Stoch</code> on <code>age</code></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="week-5-regression-ii-model-specification.html#cb73-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(predicted_LeftToRight_AdjIntercept_Stoch <span class="sc">~</span> age, <span class="at">data =</span> selects19)</span>
<span id="cb73-2"><a href="week-5-regression-ii-model-specification.html#cb73-2" tabindex="-1"></a>rsq_sd1_AdjIntercept <span class="ot">&lt;-</span> <span class="fu">summary</span>(result)<span class="sc">$</span>r.squared</span>
<span id="cb73-3"><a href="week-5-regression-ii-model-specification.html#cb73-3" tabindex="-1"></a>coeffs13 <span class="ot">&lt;-</span> <span class="fu">coef</span>(result)</span>
<span id="cb73-4"><a href="week-5-regression-ii-model-specification.html#cb73-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Intercept:&#39;</span>,<span class="fu">unname</span>(coeffs13[<span class="dv">1</span>]), <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">Slope:&#39;</span>, <span class="fu">unname</span>(coeffs13[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## Intercept: 6.122055 
## 
## Slope: 0.01948902</code></pre>
<p>Report the <span class="math inline">\(R^2\)</span> generated in points 2, 11, and 13 here:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="week-5-regression-ii-model-specification.html#cb75-1" tabindex="-1"></a>tableSD1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb75-2"><a href="week-5-regression-ii-model-specification.html#cb75-2" tabindex="-1"></a>  <span class="at">LookR2 =</span> <span class="fu">c</span>(<span class="st">&#39;Point 2&#39;</span>, <span class="st">&#39;Point 12&#39;</span>, <span class="st">&#39;Point 13&#39;</span>),</span>
<span id="cb75-3"><a href="week-5-regression-ii-model-specification.html#cb75-3" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&#39;Unchanged&#39;</span>, <span class="st">&#39;P2 + (slope*5)&#39;</span>, <span class="st">&#39;P2+(intercept+2)&#39;</span>),</span>
<span id="cb75-4"><a href="week-5-regression-ii-model-specification.html#cb75-4" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">c</span>(rsq_sd1, rsq_sd1_AdjSlope, rsq_sd1_AdjIntercept),    </span>
<span id="cb75-5"><a href="week-5-regression-ii-model-specification.html#cb75-5" tabindex="-1"></a>  <span class="at">LookParams =</span> <span class="fu">c</span>(<span class="st">&#39;Point 1&#39;</span>, <span class="st">&#39;Point 12&#39;</span>, <span class="st">&#39;Point 13&#39;</span>),</span>
<span id="cb75-6"><a href="week-5-regression-ii-model-specification.html#cb75-6" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">c</span>(<span class="fu">unname</span>(coeffs1[<span class="dv">1</span>]), <span class="fu">unname</span>(coeffs12[<span class="dv">1</span>]), <span class="fu">unname</span>(coeffs13[<span class="dv">1</span>])),    </span>
<span id="cb75-7"><a href="week-5-regression-ii-model-specification.html#cb75-7" tabindex="-1"></a>  <span class="at">Slope =</span> <span class="fu">c</span>(<span class="fu">unname</span>(coeffs1[<span class="dv">2</span>]), <span class="fu">unname</span>(coeffs12[<span class="dv">2</span>]), <span class="fu">unname</span>(coeffs13[<span class="dv">2</span>]))</span>
<span id="cb75-8"><a href="week-5-regression-ii-model-specification.html#cb75-8" tabindex="-1"></a>)</span>
<span id="cb75-9"><a href="week-5-regression-ii-model-specification.html#cb75-9" tabindex="-1"></a></span>
<span id="cb75-10"><a href="week-5-regression-ii-model-specification.html#cb75-10" tabindex="-1"></a></span>
<span id="cb75-11"><a href="week-5-regression-ii-model-specification.html#cb75-11" tabindex="-1"></a><span class="fu">print</span>(tableSD1)</span></code></pre></div>
<pre><code>##     LookR2            Model        R2 LookParams Intercept      Slope
## 1  Point 2        Unchanged 0.0161515    Point 1  4.122055 0.01948902
## 2 Point 12   P2 + (slope*5) 0.2973214   Point 12  4.071965 0.09874777
## 3 Point 13 P2+(intercept+2) 0.0161515   Point 13  6.122055 0.01948902</code></pre>
<ol start="14" style="list-style-type: decimal">
<li>Comparing the <span class="math inline">\(R^2\)</span> and the parameters across the models of points 1, 2, and 3 answer the following questions:</li>
</ol>
<ol style="list-style-type: lower-roman">
<li>What effect does increasing the slope of the data generating process (while keeping the residuals and intercept unchanged) have on the <span class="math inline">\(R^2\)</span>?</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="week-5-regression-ii-model-specification.html#cb77-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;The R2 increases as seen in point 11&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The R2 increases as seen in point 11&quot;</code></pre>
<ol start="2" style="list-style-type: lower-roman">
<li>What effect does increasing the intercept of the data generating process (while keeping the residuals and slope unchanged) have on the <span class="math inline">\(R^2\)</span>?</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="week-5-regression-ii-model-specification.html#cb79-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;The R2 stays unchanged as the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged) as well as the average distance between each observation and the average observation remained unchainged (i.e., Y</span><span class="sc">\&#39;</span><span class="st">s variance was kept unchanged)&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The R2 stays unchanged as the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged) as well as the average distance between each observation and the average observation remained unchainged (i.e., Y&#39;s variance was kept unchanged)&quot;</code></pre>
<ol start="3" style="list-style-type: lower-roman">
<li>What effect does increasing the slope of the data generating process (while keeping the residuals and intercept unchanged) have on the intercept and slope?</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="week-5-regression-ii-model-specification.html#cb81-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;It increases the estimated slope and decreases the intercept.&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;It increases the estimated slope and decreases the intercept.&quot;</code></pre>
<ol start="4" style="list-style-type: lower-roman">
<li>What effect does increasing the intercept of the data generating process (while keeping the residuals and slope unchanged) have on the intercept and slope?</li>
</ol>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="week-5-regression-ii-model-specification.html#cb83-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;It keeps the estimated slope unchanged and the estimated intercept is the same as before the adjustment but increases by the same value that the whole data generating process was modified.&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;It keeps the estimated slope unchanged and the estimated intercept is the same as before the adjustment but increases by the same value that the whole data generating process was modified.&quot;</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4-regression-i-prediction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Week5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
