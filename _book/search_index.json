[["week-5-regression-ii-model-specification.html", "Chapter 6 Week 5: Regression II (Model Specification) 6.1 Aims 6.2 Exercise: Context and Questions 6.3 Getting the data first 6.4 Exercise: solution 6.5 Interactive Line Plot", " Chapter 6 Week 5: Regression II (Model Specification) 6.1 Aims Using multiple regressors and interaction terms in regression analysis for quantitative descriptive purposes with real data Using simulation to instantiate how different properties of the data generating process alter or not metrics of goodness of fit Should we request them to do descriptive statistics?. Check: are all list numerals fine?. Check: do all parameters in the interpretation texts fine?. 6.2 Exercise: Context and Questions Currently led by Prof. Anke Tresch, “[t]he Swiss Election Study (Selects) has been investigating the electoral behaviour of Swiss citizens in national elections since 1995. The project sheds light on the dynamics of the citizens’ opinion formation as well as on the determinants of their political participation and voting choice for a specific candidate or party.” See more here. In this exercise, you will use data for the year 2019. You will use it to answer the following questions: Do older voters have stronger right leaning preferences than younger ones? age Does that behavior change across sexes? sex Does that behavior change depending on the main language spoken at the respondent’s home? f20221 What about the interaction sex-age? What about the interaction sex-language? What about the interaction age-language? What about the interaction sex-age-language? Do right leaning preferences become stronger the older voters are? 6.3 Getting the data first Opening: selects19 &lt;- read.csv(&quot;~/Documents/0_IPZ/2023_2/Leemann-QuantMethods/QuantitativeMethods/QuantitativeMethods/Data/SELECTS 2019/1179_Selects2019_PES_Data_v1.1.0.csv&quot;, header = TRUE) selects19 &lt;- selects19 %&gt;% select(sex, age, matches(&quot;f15200&quot;), f20221) %&gt;% filter(!is.na(selects19$sex) &amp; !is.na(selects19$age) &amp; !is.na(selects19$f15200) &amp; !is.na(selects19$f20221)) # Remove rows where x or y is NA selects19$f15200 &lt;- as.numeric(selects19$f15200) Labeling languages: selects19 &lt;- selects19 %&gt;% mutate(LanguageHome = case_when( f20221 == 1 ~ &quot;German/Swiss German&quot;, f20221 == 2 ~ &quot;French&quot;, f20221 == 3 ~ &quot;Italian&quot;, f20221 == 4 ~ &quot;Romansh&quot;, f20221 == 5 ~ &quot;Other&quot;)) Labeling sex: selects19 &lt;- selects19 %&gt;% mutate(Sex = case_when( sex == 1 ~ &quot;Male&quot;, sex == 2 ~ &quot;Female&quot;)) Renaming political preferences: selects19 &lt;- dplyr::rename(selects19, LeftToRight = f15200) 6.4 Exercise: solution Note: Remember that you can copy the code from one point to answer another point. Simply make the necessary adjustments. 6.4.1 Real data Graph age vs. political preferences. Use a linear regression line to describe how the variables relate to each other. #Means for Y and X mean_LeftRight &lt;- mean(selects19$LeftToRight, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = LeftToRight)) + geom_point() + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 10), breaks = seq(0, 10, by = 1)) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences&quot; ) Since the political preferences as well as years are defined in discrete values, many values can overlap for the same pair(preference, age). Use the ggridges package to see how do preferences distribute across different age values. # Assuming `data` is your dataframe with &#39;age&#39;, &#39;political_preference&#39; and &#39;LeftToRight&#39; as columns # Replace `data`, `age`, `political_preference`, and `LeftToRight` with your actual dataframe and variable names. ggplot(selects19, aes(x = age, y = as.factor(LeftToRight), fill = as.factor(LeftToRight))) + geom_density_ridges() + geom_smooth(data = selects19, aes(x = age, y = LeftToRight, group = 1), method = &quot;lm&quot;, formula = y ~ x, color = &quot;red&quot;, se = FALSE) + geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + scale_fill_viridis_d() + theme_minimal() + theme(legend.position = &quot;none&quot;) + labs(x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Ridge Plot of Age by Number of Houses&quot;, fill = &quot;factor(LeftToRight)&quot;) ## Picking joint bandwidth of 4.52 ## Warning: The following aesthetics were dropped during statistical transformation: fill ## ℹ This can happen when ggplot fails to infer the correct grouping structure in ## the data. ## ℹ Did you forget to specify a `group` aesthetic or to convert a numerical ## variable into a factor? Regress the political preferences on age. As we learnt in the exercises from last week, the regression with intercept fits data better in most cases: act accordingly. Report and interpret the parameters. Graph some of the main components of the regression output. Write the regression here. #regression result &lt;- lm(LeftToRight ~ age, data = selects19) summary(result) ## ## Call: ## lm(formula = LeftToRight ~ age, data = selects19) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.9150 -2.0380 -0.0186 2.1958 5.5271 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 4.122055 0.106375 38.750 &lt;2e-16 *** ## age 0.019489 0.001979 9.846 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.649 on 5905 degrees of freedom ## Multiple R-squared: 0.01615, Adjusted R-squared: 0.01598 ## F-statistic: 96.94 on 1 and 5905 DF, p-value: &lt; 2.2e-16 Report and interpret the parameters here. coeffs&lt;- coef(result) cat(&#39;The beta value for&#39;, names(coeffs[1]), &#39; is &#39;, round(unname(coeffs[1]), digits = 2), &#39; and for &#39;, names(coeffs[2]), &#39; is &#39;, round(unname(coeffs[2]), digits = 2), &#39;. \\n\\nIt means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;, round(unname(coeffs[2]), digits = 2), &#39; \\&#39;ideological units\\&#39;. Likewise, newborns can be expected to have an average ideological value of &#39;,round(unname(coeffs[1]), digits = 2),&#39;, while 100 year old citizens can be expected to have an average ideological value of.&#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100) ## The beta value for (Intercept) is 4.12 and for age is 0.02 . ## ## It means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of 0.02 &#39;ideological units&#39;. Likewise, newborns can be expected to have an average ideological value of 4.12 , while 100 year old citizens can be expected to have an average ideological value of. 6.12 Graph some of the main components of the regression output here. ggplot(selects19, aes(x = age, y = LeftToRight)) + # Removed selects19$ from aes(), not necessary geom_point(size = 0.001) + geom_abline(intercept = unname(coeffs[1]), slope = 0, color = &quot;gray&quot;, size = 1) + geom_text(aes(label = &quot;Newborn&quot;, x = max(selects19$age)+10, y = 0.2+unname(coeffs[1])), hjust = 1, vjust = 0, color = &quot;gray&quot;)+ geom_abline(intercept = unname(coeffs[1]), slope = unname(coeffs[2]), color = &quot;red&quot;, size = 1) + geom_text(aes(label = &quot;Average individual over time&quot;, x = max(selects19$age)+10, y = 0.4+unname(coeffs[1]) + unname(coeffs[2]) * max(selects19$age)), hjust = 1, vjust = 0, color = &quot;red&quot;) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Lines Using Parameters from Regression&quot; ) ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. ## Warning: Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. Now add the regressor Sex and do the same as in the previous point. Write the regression here. #regression result &lt;- lm(LeftToRight ~ age + Sex, data = selects19) summary(result) ## ## Call: ## lm(formula = LeftToRight ~ age + Sex, data = selects19) ## ## Residuals: ## Min 1Q Median 3Q Max ## -6.2108 -1.9784 0.0954 2.1145 5.8236 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.840287 0.109636 35.028 &lt;2e-16 *** ## age 0.018672 0.001966 9.496 &lt;2e-16 *** ## SexMale 0.652678 0.068477 9.531 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.629 on 5904 degrees of freedom ## Multiple R-squared: 0.03106, Adjusted R-squared: 0.03073 ## F-statistic: 94.63 on 2 and 5904 DF, p-value: &lt; 2.2e-16 Report and interpret the parameters here. coeffs&lt;- coef(result) cat(&#39;The beta value for&#39;, names(coeffs[1]), &#39; is &#39;, round(unname(coeffs[1]), digits = 2), &#39; for &#39;, names(coeffs[2]), &#39; is &#39;, round(unname(coeffs[2]), digits = 2), &#39; and for &#39;, names(coeffs[3]), &#39; is &#39;, round(unname(coeffs[3]), digits = 2), &#39;. \\n\\nIt means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;, round(unname(coeffs[2]), digits = 2), &#39; \\&#39;ideological units\\&#39;. Likewise, newborns can be expected to have an average ideological value of &#39;,round(unname(coeffs[1]), digits = 2),&#39;, while 100 year old female citizens can be expected to have an average ideological value of.&#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100, &#39;. Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of &#39;, round(unname(coeffs[3]), digits = 2), &#39; ideological units higher than a female individual under the same statistical circumstances.&#39;) ## The beta value for (Intercept) is 3.84 for age is 0.02 and for SexMale is 0.65 . ## ## It means that, given our model, an increase of one year in age across the Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of 0.02 &#39;ideological units&#39;. Likewise, newborns can be expected to have an average ideological value of 3.84 , while 100 year old female citizens can be expected to have an average ideological value of. 5.84 . Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of 0.65 ideological units higher than a female individual under the same statistical circumstances. Graph some of the main components of the regression output here. ggplot(selects19, aes(x = age, y = LeftToRight)) + # Removed selects19$ from aes(), not necessary geom_point(size = 0.001) + geom_abline(intercept = unname(coeffs[1]), slope = 0, color = &quot;gray&quot;, size = 1) + geom_text(aes(label = &quot;Newborn female&quot;, x = max(selects19$age)+10, y = 0.2+unname(coeffs[1])), hjust = 1, vjust = 0, color = &quot;gray&quot;)+ geom_abline(intercept = unname(coeffs[1]), slope = unname(coeffs[2]), color = &quot;red&quot;, size = 1) + geom_text(aes(label = &quot;Female over time&quot;, x = max(selects19$age)+10, y = -0.8+unname(coeffs[1]) + unname(coeffs[2]) * max(selects19$age)), hjust = 1, vjust = 0, color = &quot;red&quot;) + geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3]), slope = unname(coeffs[2]), color = &quot;orange&quot;, size = 1) + geom_text(aes(label = &quot;Male over time (newborn bonus)&quot;, x = max(selects19$age)+10, y = 0.6+unname(coeffs[1])+unname(coeffs[3]) + unname(coeffs[2]) * max(selects19$age)+0.2), hjust = 1, vjust = 0, color = &quot;orange&quot;) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Lines Using Parameters from Regression&quot; ) ## Warning: Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. You now remember that average preferences can change not only across age and sex independently, but simultaneously: i.e., the average preferences across individuals in a same sex can change at different rates over time as well as begin from different points. Add the interaction Age and Sex and do the same as in the previous point. Write the regression here. #regression result &lt;- lm(LeftToRight ~ age * Sex, data = selects19) summary(result) ## ## Call: ## lm(formula = LeftToRight ~ age * Sex, data = selects19) ## ## Residuals: ## Min 1Q Median 3Q Max ## -5.9332 -2.0641 0.0372 2.1848 6.0372 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.506922 0.146203 23.987 &lt; 2e-16 *** ## age 0.025327 0.002756 9.189 &lt; 2e-16 *** ## SexMale 1.340734 0.211254 6.347 2.37e-10 *** ## age:SexMale -0.013528 0.003930 -3.443 0.00058 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.626 on 5903 degrees of freedom ## Multiple R-squared: 0.033, Adjusted R-squared: 0.03251 ## F-statistic: 67.15 on 3 and 5903 DF, p-value: &lt; 2.2e-16 Report and interpret the parameters here. coeffs&lt;- coef(result) cat(&#39;The beta value for&#39;, names(coeffs[1]), &#39; is &#39;, round(unname(coeffs[1]), digits = 2), &#39; for &#39;, names(coeffs[2]), &#39; is &#39;, round(unname(coeffs[2]), digits = 2), &#39; for &#39;, names(coeffs[3]), &#39; is &#39;, round(unname(coeffs[3]), digits = 2),&#39; and for &#39;, names(coeffs[4]), &#39; is &#39;, round(unname(coeffs[4]), digits = 2), &#39;. \\n\\nIt means that, given our model, an increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;, round(unname(coeffs[2]), digits = 2), &#39; \\&#39;ideological units\\&#39;. Likewise, female newborns can be expected to have an average ideological value of &#39;,round(unname(coeffs[1]), digits = 2),&#39;, while 100 year old female citizens can be expected to have an average ideological value of.&#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100, &#39;. \\n\\nSimilarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of &#39;, round(unname(coeffs[3]), digits = 2), &#39; ideological units higher (i.e., self declare more right leaning) than a female individual under the same statistical circumstances. Finally, the rate at which right leaning prefferences increase over time is &#39;, round(unname(coeffs[4]), digits = 2)*-1, &#39; lower than a female in the same statistical circumstances. Therefore, a 100 year old male can be expected to have an political preference of &#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100+round(unname(coeffs[3]), digits = 2)+round(unname(coeffs[4]), digits = 2)*100) ## The beta value for (Intercept) is 3.51 for age is 0.03 for SexMale is 1.34 and for age:SexMale is -0.01 . ## ## It means that, given our model, an increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of 0.03 &#39;ideological units&#39;. Likewise, female newborns can be expected to have an average ideological value of 3.51 , while 100 year old female citizens can be expected to have an average ideological value of. 6.51 . ## ## Similarly, for each of those scenarios, should the individual be a male, it can be expected to have an average of 1.34 ideological units higher (i.e., self declare more right leaning) than a female individual under the same statistical circumstances. Finally, the rate at which right leaning prefferences increase over time is 0.01 lower than a female in the same statistical circumstances. Therefore, a 100 year old male can be expected to have an political preference of 6.85 Graph some of the main components of the regression output here. ggplot(selects19, aes(x = age, y = LeftToRight)) + geom_point(size = 0) + geom_abline(intercept = unname(coeffs[1]), slope = 0, color = &quot;gray&quot;, size = 1) + geom_text(aes(label = &quot;Newborn female&quot;, x = max(selects19$age)+10, y = -0.5+unname(coeffs[1])), hjust = 1, vjust = 0, color = &quot;gray&quot;)+ geom_abline(intercept = unname(coeffs[1]), slope = unname(coeffs[2]), color = &quot;red&quot;, size = 1) + geom_text(aes(label = &quot;Female over time&quot;, x = max(selects19$age)+10, y = -0.8+unname(coeffs[1]) + unname(coeffs[2]) * max(selects19$age)), hjust = 1, vjust = 0, color = &quot;red&quot;) + geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3]), slope = unname(coeffs[2])+unname(coeffs[4]), color = &quot;orange&quot;, size = 1) + geom_text(aes(label = &quot;Male over time (newborn bonus+Δslope)&quot;, x = max(selects19$age)+10, y = 0.45+unname(coeffs[1])+unname(coeffs[3]) + (unname(coeffs[2])+unname(coeffs[4])) * max(selects19$age)), hjust = 1, vjust = 0, color = &quot;orange&quot;) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Lines Using Parameters from Regression&quot; ) ## Warning: Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. Following the same logic as in the previous point, you now add the LanguageHome categorical variable with the corresponding interactions. Do the same as in the previous point. Write the regression here. #regression result &lt;- lm(LeftToRight ~ age * Sex * LanguageHome, data = selects19) summary(result) ## ## Call: ## lm(formula = LeftToRight ~ age * Sex * LanguageHome, data = selects19) ## ## Residuals: ## Min 1Q Median 3Q Max ## -6.1650 -2.0129 0.0157 2.0714 6.1504 ## ## Coefficients: ## Estimate Std. Error t value ## (Intercept) 3.4304317 0.2328505 14.732 ## age 0.0232899 0.0043627 5.338 ## SexMale 1.2217711 0.3489102 3.502 ## LanguageHomeGerman/Swiss German 0.0096680 0.3214760 0.030 ## LanguageHomeItalian 1.4371272 0.5006063 2.871 ## LanguageHomeOther -1.1059089 0.6179065 -1.790 ## LanguageHomeRomansh -2.3047615 3.5040694 -0.658 ## age:SexMale -0.0140639 0.0065181 -2.158 ## age:LanguageHomeGerman/Swiss German 0.0053104 0.0060152 0.883 ## age:LanguageHomeItalian -0.0154796 0.0095441 -1.622 ## age:LanguageHomeOther 0.0169430 0.0126468 1.340 ## age:LanguageHomeRomansh 0.0425055 0.0732632 0.580 ## SexMale:LanguageHomeGerman/Swiss German 0.1885585 0.4684575 0.403 ## SexMale:LanguageHomeItalian -0.5629460 0.7043389 -0.799 ## SexMale:LanguageHomeOther 1.6468317 0.9783983 1.683 ## SexMale:LanguageHomeRomansh 1.0259620 4.0396347 0.254 ## age:SexMale:LanguageHomeGerman/Swiss German 0.0002337 0.0086831 0.027 ## age:SexMale:LanguageHomeItalian 0.0124492 0.0133246 0.934 ## age:SexMale:LanguageHomeOther -0.0265266 0.0193016 -1.374 ## age:SexMale:LanguageHomeRomansh 0.0041536 0.0833735 0.050 ## Pr(&gt;|t|) ## (Intercept) &lt; 2e-16 *** ## age 9.73e-08 *** ## SexMale 0.000466 *** ## LanguageHomeGerman/Swiss German 0.976009 ## LanguageHomeItalian 0.004109 ** ## LanguageHomeOther 0.073543 . ## LanguageHomeRomansh 0.510732 ## age:SexMale 0.030994 * ## age:LanguageHomeGerman/Swiss German 0.377368 ## age:LanguageHomeItalian 0.104877 ## age:LanguageHomeOther 0.180393 ## age:LanguageHomeRomansh 0.561819 ## SexMale:LanguageHomeGerman/Swiss German 0.687324 ## SexMale:LanguageHomeItalian 0.424175 ## SexMale:LanguageHomeOther 0.092391 . ## SexMale:LanguageHomeRomansh 0.799525 ## age:SexMale:LanguageHomeGerman/Swiss German 0.978527 ## age:SexMale:LanguageHomeItalian 0.350189 ## age:SexMale:LanguageHomeOther 0.169395 ## age:SexMale:LanguageHomeRomansh 0.960268 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.615 on 5887 degrees of freedom ## Multiple R-squared: 0.04377, Adjusted R-squared: 0.04068 ## F-statistic: 14.18 on 19 and 5887 DF, p-value: &lt; 2.2e-16 Report and interpret the parameters here. coeffs &lt;- coef(result) cat(&#39;Interpreting a regression with ever more interactions is exponentially harder! Thus, find below some few cases aimed at signaling the general logic in the interpretation.&#39;, &#39;\\n\\nAn increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of &#39;, round(unname(coeffs[2]), digits = 2), &#39; \\&#39;ideological units\\&#39;. Likewise, female newborns whose household speaks mainly in French can be expected to have an average ideological value of &#39;,round(unname(coeffs[1]), digits = 2),&#39;, while a 100 year old female citizens whose household speaks mainly in French can be expected to have an average ideological value of.&#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100, &#39;.\\n\\nSimilarly, should one observe a random 100 year old male individual whose household speaks mainly in German, we can expected him have an average of &#39;, round(unname(coeffs[2]), digits = 2)*100+round(unname(coeffs[3]), digits = 2)+round(unname(coeffs[8]), digits = 2)*100+round(unname(coeffs[9]), digits = 2)*100+round(unname(coeffs[13]), digits = 2)+round(unname(coeffs[17]), digits = 2)*100, &#39; ideological units higher than a female newborn whose household speaks mainly in French. Consequently, the expected ideological value for the former would be of &#39;, round(unname(coeffs[1]), digits = 2)+round(unname(coeffs[2]), digits = 2)*100+round(unname(coeffs[3]), digits = 2)+round(unname(coeffs[8]), digits = 2)*100+round(unname(coeffs[9]), digits = 2)*100+round(unname(coeffs[13]), digits = 2)+round(unname(coeffs[17]), digits = 2)*100) ## Interpreting a regression with ever more interactions is exponentially harder! Thus, find below some few cases aimed at signaling the general logic in the interpretation. ## ## An increase of one year in age across the female Swiss citizens is associated with an average increase in the LeftToRight self-declared scale of 0.02 &#39;ideological units&#39;. Likewise, female newborns whose household speaks mainly in French can be expected to have an average ideological value of 3.43 , while a 100 year old female citizens whose household speaks mainly in French can be expected to have an average ideological value of. 5.43 . ## ## Similarly, should one observe a random 100 year old male individual whose household speaks mainly in German, we can expected him have an average of 3.41 ideological units higher than a female newborn whose household speaks mainly in French. Consequently, the expected ideological value for the former would be of 6.84 Graph some of the main components of the regression output here. ggplot(selects19, aes(x = age, y = LeftToRight)) + # Removed selects19$ from aes(), not necessary geom_point(size = 0) + geom_abline(intercept = unname(coeffs[1]), slope = 0, color = &quot;gray&quot;, size = 1) + geom_text(aes(label = &quot;Newborn female French speaking household&quot;, x = max(selects19$age)+10, y = 0.1+unname(coeffs[1])), hjust = 1, vjust = 0, color = &quot;gray&quot;)+ geom_abline(intercept = unname(coeffs[1]), slope = unname(coeffs[2]), color = &quot;red&quot;, size = 1) + geom_text(aes(label = &quot;Female French speaking household over time&quot;, x = max(selects19$age)+10, y = -1.6+unname(coeffs[1]) + unname(coeffs[2]) * max(selects19$age)), hjust = 1, vjust = 0, color = &quot;red&quot;) + geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3]), slope = unname(coeffs[2])+unname(coeffs[8]), color = &quot;orange&quot;, size = 1) + geom_text(aes(label = &quot;Male French household over time (newborn bonus+Δslope)&quot;, x = max(selects19$age)+10, y = 0.4+unname(coeffs[1])+unname(coeffs[3]) + (unname(coeffs[2])+unname(coeffs[8])) * max(selects19$age)+0.2), hjust = 1, vjust = 0, color = &quot;orange&quot;) + geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3])+unname(coeffs[13]), slope = unname(coeffs[2])+unname(coeffs[8])+unname(coeffs[17]), color = &quot;purple&quot;, size = 1) + geom_text(aes(label = &quot;Male German household over time (newborn &amp; ling. bonus+Δslope)&quot;, x = max(selects19$age)+10, y = 1.2+unname(coeffs[1])+unname(coeffs[3])+unname(coeffs[13]) + (unname(coeffs[2])+unname(coeffs[8])+unname(coeffs[17])) * max(selects19$age)+0.2), hjust = 1, vjust = 0, color = &quot;purple&quot;) + # geom_abline(intercept = unname(coeffs[1])+unname(coeffs[3]), # slope = unname(coeffs[2])+unname(coeffs[4]), color = &quot;blue&quot;, size = 1) + # geom_text(aes(label = &quot;Int.(fem)+Male+Age*Male&quot;, # x = max(selects19$age)+10, # y = 0.3+unname(coeffs[1])+unname(coeffs[3]) + (unname(coeffs[2])+unname(coeffs[4])) * max(selects19$age)+0.2), # hjust = 1, vjust = 0, color = &quot;blue&quot;) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Lines Using Parameters from Regression&quot; ) ## Warning: Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. ## Use of `selects19$age` is discouraged. ## ℹ Use `age` instead. Ojo: Check that interpretations have the right parameters!. 6.5 Interactive Line Plot Should we exploit this here or somewhere else? I can make it work in R, but not in the book yet. If needed, I can check it out.. # # Example data frame # data &lt;- data.frame( # x = rnorm(100), # y = rnorm(100) # ) # # # Shiny server function # server &lt;- function(input, output) { # output$scatterPlot &lt;- renderPlot({ # ggplot(data, aes(x = x, y = y)) + # Ensure &#39;data&#39; is your data frame # geom_point(size = 0) + # geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1) # }) # } # # # Example data frame # data &lt;- data.frame( # x = rnorm(100), # y = rnorm(100) # ) # # # Shiny server function # server &lt;- function(input, output) { # output$scatterPlot &lt;- renderPlot({ # ggplot(data, aes(x = x, y = y)) + # Ensure &#39;data&#39; is your data frame # geom_point(size = 0) + # geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1) # }) # } # # update.packages(ask = FALSE) # # # library(shiny) # library(ggplot2) # # ui &lt;- fluidPage( # titlePanel(&quot;Interactive Line Plot&quot;), # sidebarLayout( # sidebarPanel( # sliderInput(&quot;intercept&quot;, &quot;Intercept:&quot;, min = -10, max = 10, value = 0), # sliderInput(&quot;slope&quot;, &quot;Slope:&quot;, min = -10, max = 10, value = 1) # ), # mainPanel( # plotOutput(&quot;scatterPlot&quot;) # ) # ) # ) # # server &lt;- function(input, output) { # output$scatterPlot &lt;- renderPlot({ # ggplot(data, aes(x = x, y = y)) + # geom_point(size = 0) + # geom_abline(intercept = input$intercept, slope = input$slope, color = &quot;red&quot;, size = 1) # }) # } # # shinyApp(ui = ui, server = server) 6.5.1 Simulated data In order to see the logic behind the \\(R^2\\), first estimate the linear regression of LeftToRight on Age. Generate the variable predicted_LeftToRight with the generated parameters using predict() from the point 3 of the previous section (i.e., the one using real data).Generate the graph predicted_LeftToRight vs Age. Report the regression here. result &lt;- lm(LeftToRight ~ age, data = selects19) selects19$predicted_LeftToRight &lt;- predict(result) coeffs1 &lt;- coef(result) rsq_sd1 &lt;- summary(result)$r.squared cat(&#39;The R2 is: &#39;, rsq_sd1, &#39;\\n\\nIntercept:&#39;,unname(coeffs1[1]), &#39;\\n\\nSlope:&#39;, unname(coeffs1[2])) ## The R2 is: 0.0161515 ## ## Intercept: 4.122055 ## ## Slope: 0.01948902 Report the graph here. # Calculate means for Y and X mean_LeftRight &lt;- mean(selects19$LeftToRight, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = predicted_LeftToRight)) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 10), breaks = seq(0, 10, by = 1) ) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences (determ. sim.)&quot; ) ## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0. ## ℹ Please use the `linewidth` argument instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. Now generate the normally distributed residuals with mean zero and the same variance as the residuals of the model from the previous point. # Calculate the variance of the residuals selects19$residual &lt;- resid(result) residual_sd &lt;- sqrt(var(resid(result))) # Set the seed for reproducibility set.seed(0) selects19$NormResiduals1 &lt;- rnorm(nrow(selects19), mean = 0, sd = residual_sd) Simulate new data using both the deterministic (i.e., the the parameters estimated immediately above) and stochastic component (i.e., the residuals form the previous point). Graph the simulated data. selects19$Sim_LeftToRight_Det_Stoch &lt;- selects19$predicted_LeftToRight + selects19$NormResiduals1 #Means for Y and X mean_LeftRight &lt;- mean(selects19$Sim_LeftToRight_Det_Stoch, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = Sim_LeftToRight_Det_Stoch)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous( limits = c(0, 10), breaks = seq(0, 10, by = 1)) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Simulation: Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences \\n(determ.&amp; stoch. sim.)&quot; ) ## Warning: Removed 366 rows containing non-finite values (`stat_smooth()`). ## Warning: Removed 366 rows containing missing values (`geom_point()`). Now, estimate the regression between the real age and simulated Sim_LeftToRight_Det_Stoch. Once you do that, generate the \\(R^2\\) for the model. result &lt;- lm(LeftToRight ~ age, data = selects19) rsq_sd1 &lt;- summary(result)$r.squared cat(&#39;The R2 is: &#39;, rsq_sd1) ## The R2 is: 0.0161515 Repeat the previous three points but use half the standard deviation of the model of point 1. Is the \\(R^2\\) lower now? Why? See this entry to understand the intuition: pay special attention to the graph with the red and blue squares. Generate the residuals here. # Set the seed for reproducibility set.seed(0) selects19$NormResiduals10 &lt;- rnorm(nrow(selects19), mean = 0, sd = residual_sd*0.1) Simulate new data and graph it here. selects19$Sim_LeftToRight_Det_Stoch_sd10 &lt;- selects19$predicted_LeftToRight + selects19$NormResiduals10 #Means for Y and X mean_LeftRight &lt;- mean(selects19$Sim_LeftToRight_Det_Stoch_sd10, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = Sim_LeftToRight_Det_Stoch_sd10)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 10), breaks = seq(0, 10, by = 1)) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Simulated data (half sd): Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences&quot; ) Report the new \\(R^2\\) here: result &lt;- lm(Sim_LeftToRight_Det_Stoch_sd10 ~ age, data = selects19) rsq_sd10 &lt;- summary(result)$r.squared cat(&#39;The R2 is: &#39;, rsq_sd10) ## The R2 is: 0.625503 Repeat the previous point but use a hundredth the standard deviation of the model of point 1. Is the \\(R^2\\) lower now? Why? Generate the residuals here. # Set the seed for reproducibility set.seed(0) selects19$NormResiduals100 &lt;- rnorm(nrow(selects19), mean = 0, sd = residual_sd*0.01) Simulate new data and graph it here. selects19$Sim_LeftToRight_Det_Stoch_hsd &lt;- selects19$predicted_LeftToRight + selects19$NormResiduals100 #Means for Y and X mean_LeftRight &lt;- mean(selects19$Sim_LeftToRight_Det_Stoch_hsd, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = Sim_LeftToRight_Det_Stoch_hsd)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 10), breaks = seq(0, 10, by = 1)) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Age (years)&quot;, y = &quot;Simulated data (half sd): Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences&quot; ) Report the new \\(R^2\\) here: result &lt;- lm(Sim_LeftToRight_Det_Stoch_hsd ~ age, data = selects19) rsq_sd100 &lt;- summary(result)$r.squared cat(&#39;The R2 is: &#39;, rsq_sd100) ## The R2 is: 0.9939772 Present in a table the \\(R^2\\) for each value of the standard deviation. table &lt;- data.frame( SD = c(1, 0.1, 0.01), R2 = c(rsq_sd1, rsq_sd10, rsq_sd100) # Replace these with the actual R-squared values ) print(table) ## SD R2 ## 1 1.00 0.0161515 ## 2 0.10 0.6255030 ## 3 0.01 0.9939772 Graph \\(R^2\\) agains the standard deviation fraction. Fit a linear regression line. ggplot(table, aes(x = SD, y = R2)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;green&quot;)+ theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Fraction of standard deviation&quot;, y = &quot;R2&quot;, title = &quot;Relation between R2 and standard deviation of residuals&quot; ) 9. [Optional] Graph \\(R^2\\) against the standard deviation fraction. Fit a regression line with a polynomial of degree 2. The regression line fits the data better. Is the polynomial regression more informative than the linear regression? Why? What lesson does this graph give you in terms of the importance of understanding the theoretical relations between variables beyond what an empirical approach could suggest? What does it teach you regarding the tension between under- and over-fitting data? ggplot(table, aes(x = SD, y = R2)) + geom_point() + geom_smooth(method = &quot;lm&quot;, formula = y ~ poly(x, 2), se = FALSE, color=&#39;green&#39;) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + labs( x = &quot;Fraction of standard deviation&quot;, y = &quot;R2&quot;, title = &quot;Relation between R2 and standard deviation of residuals&quot; ) 10. Print the parameters generated in the point 1. Generate the same predictions as in point 1 and 2 but this time multiply the slope’s parameter by 5, while keeping the intercept unchanged. Call the resulting predictions predicted_LeftToRight_AdjSlope Generate a graph with the regression line for predicted_LeftToRight_AdjSlope vs Age and compare it with the graph predicted_LeftToRight vs Age generated in point 1. Print here result &lt;- lm(LeftToRight ~ age, data = selects19) # summary(result) coeffs &lt;- coef(result) cat(&#39;Intercept:&#39;,unname(coeffs[1]), &#39;\\n\\nSlope:&#39;, unname(coeffs[2])) ## Intercept: 4.122055 ## ## Slope: 0.01948902 Predict with the adjusted slope here. selects19$predicted_LeftToRight_AdjSlope &lt;- unname(coeffs[1])+(unname(coeffs[2])*5)*selects19$age Generate the graph here. #Means for Y and X mean_LeftRight &lt;- mean(selects19$predicted_LeftToRight_AdjSlope, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = predicted_LeftToRight_AdjSlope)) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous( limits = c(0, 15), breaks = seq(0, 20, by = 1)) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences (adj. slope)&quot; ) 11. Add to the deterministic simulation the same stochastic component generated in point 2. Call that variable predicted_LeftToRight_AdjSlope_Stoch. Generate the graph predicted_LeftToRight_AdjSlope_Stoch vs age with a linear regression line. Generate the \\(R^2\\) and compare it to the one generated in point 4. Why is the new \\(R^2\\) higher than the one in point 4? Report the simulation and the graph here. selects19$predicted_LeftToRight_AdjSlope_Stoch &lt;- selects19$predicted_LeftToRight_AdjSlope + selects19$NormResiduals1 #Means for Y and X mean_LeftRight &lt;- mean(selects19$predicted_LeftToRight_AdjSlope_Stoch, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = predicted_LeftToRight_AdjSlope_Stoch)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 20), breaks = seq(0, 20, by = 1)) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Simulation: Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences \\n(determ.&amp; stoch. sim. with adjusted slope)&quot; ) ## Warning: Removed 12 rows containing non-finite values (`stat_smooth()`). ## Warning: Removed 12 rows containing missing values (`geom_point()`). Report the new \\(R^2\\) here: result &lt;- lm(predicted_LeftToRight_AdjSlope_Stoch ~ age, data = selects19) rsq_sd1_AdjSlope &lt;- summary(result)$r.squared cat(&#39;The R2 is: &#39;, rsq_sd1_AdjSlope) ## The R2 is: 0.2973214 Report why is the new \\(R^2\\) higher than the one in point 4? print(&#39;The reason the R2 increased is that, while the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged), by increasing the slope of the generating process, the average distance between each observation and the average observation increased (i.e., Y\\&#39;s variance increased). See the graph with the red and blue squares mentioned in point 5.&#39;) ## [1] &quot;The reason the R2 increased is that, while the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged), by increasing the slope of the generating process, the average distance between each observation and the average observation increased (i.e., Y&#39;s variance increased). See the graph with the red and blue squares mentioned in point 5.&quot; 333333333333 Print the parameters generated in the point 1. Generate the same predictions as in point 1 and 2 but this time increase in two units the intercept’s parameter (not the slope’s parameter as in the point 10), while keeping the slope unchanged. Call the resulting predictions predicted_LeftToRight_AdjSlope Generate a graph with the regression line for predicted_LeftToRight_AdjSlope vs Age and compare it with the graph predicted_LeftToRight vs Age generated in point 1. Print here result &lt;- lm(predicted_LeftToRight_AdjSlope_Stoch ~ age, data = selects19) # summary(result) coeffs12 &lt;- coef(result) cat(&#39;Intercept:&#39;,unname(coeffs12[1]), &#39;\\n\\nSlope:&#39;, unname(coeffs12[2])) ## Intercept: 4.071965 ## ## Slope: 0.09874777 Predict with the adjusted slope here. selects19$predicted_LeftToRight_AdjIntecept &lt;- unname(coeffs[1]+2)+(unname(coeffs[2]))*selects19$age Generate the graph here. #Means for Y and X mean_LeftRight &lt;- mean(selects19$predicted_LeftToRight_AdjIntecept, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = predicted_LeftToRight_AdjIntecept)) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous( limits = c(0, 15), breaks = seq(0, 20, by = 1)) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences (adj. slope)&quot; ) 13. Add to the deterministic simulation the same stochastic component generated in point 2. Call that variable predicted_LeftToRight_AdjIntercep_Stoch. Generate the graph predicted_LeftToRight_AdjIntecept vs age with a linear regression line. Generate the \\(R^2\\) and compare it to the one generated in point 4. Why is the new \\(R^2\\) higher than the one in point 4? Report the simulation and the graph here. selects19$predicted_LeftToRight_AdjIntercept_Stoch &lt;- selects19$predicted_LeftToRight_AdjIntecept + selects19$residual #Means for Y and X mean_LeftRight &lt;- mean(selects19$predicted_LeftToRight_AdjIntercept_Stoch, na.rm = TRUE) mean_age &lt;- mean(selects19$age, na.rm = TRUE) # Create a scatter plot ggplot(selects19, aes(x = age, y = predicted_LeftToRight_AdjIntercept_Stoch)) + geom_point(size = 0) + geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = FALSE, color = &quot;red&quot;) + # Adding the regression line geom_hline(yintercept = mean_LeftRight, linetype = &quot;dashed&quot;, color = &quot;green&quot;) + # Horizontal line at the mean of y geom_vline(xintercept = mean_age, linetype = &quot;dashed&quot;, color = &quot;orange&quot;) + # Vertical line at the mean of x scale_y_continuous( limits = c(0, 20), breaks = seq(0, 20, by = 1)) + theme_minimal() + theme( plot.title = element_text(hjust = 0.5), # Center the plot title panel.grid.major.y = element_line(color = &quot;grey80&quot;, size = 0.5), # Style for major Y grid lines panel.grid.minor.y = element_blank() # Remove minor Y grid lines ) + labs( x = &quot;Age (years)&quot;, y = &quot;Simulation: Political Preferences (left to right)&quot;, title = &quot;Scatter plot Age vs. Political Preferences \\n(determ.&amp; stoch. sim. with adjusted intercept)&quot; ) Regress the predicted_LeftToRight_AdjIntercept_Stoch on age result &lt;- lm(predicted_LeftToRight_AdjIntercept_Stoch ~ age, data = selects19) rsq_sd1_AdjIntercept &lt;- summary(result)$r.squared coeffs13 &lt;- coef(result) cat(&#39;Intercept:&#39;,unname(coeffs13[1]), &#39;\\n\\nSlope:&#39;, unname(coeffs13[2])) ## Intercept: 6.122055 ## ## Slope: 0.01948902 Report the \\(R^2\\) generated in points 2, 11, and 13 here: tableSD1 &lt;- data.frame( LookR2 = c(&#39;Point 2&#39;, &#39;Point 12&#39;, &#39;Point 13&#39;), Model = c(&#39;Unchanged&#39;, &#39;P2 + (slope*5)&#39;, &#39;P2+(intercept+2)&#39;), R2 = c(rsq_sd1, rsq_sd1_AdjSlope, rsq_sd1_AdjIntercept), LookParams = c(&#39;Point 1&#39;, &#39;Point 12&#39;, &#39;Point 13&#39;), Intercept = c(unname(coeffs1[1]), unname(coeffs12[1]), unname(coeffs13[1])), Slope = c(unname(coeffs1[2]), unname(coeffs12[2]), unname(coeffs13[2])) ) print(tableSD1) ## LookR2 Model R2 LookParams Intercept Slope ## 1 Point 2 Unchanged 0.0161515 Point 1 4.122055 0.01948902 ## 2 Point 12 P2 + (slope*5) 0.2973214 Point 12 4.071965 0.09874777 ## 3 Point 13 P2+(intercept+2) 0.0161515 Point 13 6.122055 0.01948902 Comparing the \\(R^2\\) and the parameters across the models of points 1, 2, and 3 answer the following questions: What effect does increasing the slope of the data generating process (while keeping the residuals and intercept unchanged) have on the \\(R^2\\)? print(&#39;The R2 increases as seen in point 11&#39;) ## [1] &quot;The R2 increases as seen in point 11&quot; What effect does increasing the intercept of the data generating process (while keeping the residuals and slope unchanged) have on the \\(R^2\\)? print(&#39;The R2 stays unchanged as the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged) as well as the average distance between each observation and the average observation remained unchainged (i.e., Y\\&#39;s variance was kept unchanged)&#39;) ## [1] &quot;The R2 stays unchanged as the distance from each observation to the regression line remained unchainged (i.e., the residual was kept unchanged) as well as the average distance between each observation and the average observation remained unchainged (i.e., Y&#39;s variance was kept unchanged)&quot; What effect does increasing the slope of the data generating process (while keeping the residuals and intercept unchanged) have on the intercept and slope? print(&#39;It increases the estimated slope and decreases the intercept.&#39;) ## [1] &quot;It increases the estimated slope and decreases the intercept.&quot; What effect does increasing the intercept of the data generating process (while keeping the residuals and slope unchanged) have on the intercept and slope? print(&#39;It keeps the estimated slope unchanged and the estimated intercept is the same as before the adjustment but increases by the same value that the whole data generating process was modified.&#39;) ## [1] &quot;It keeps the estimated slope unchanged and the estimated intercept is the same as before the adjustment but increases by the same value that the whole data generating process was modified.&quot; "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
